---
title: "Stability of flower visitation rate over time is driven by the asynchrony of pollinator abundances but does not determine the stability of plant reproductive success."
author: "Estefanía Tobajas^1, Virginia Domínguez-García^1, Francisco P. Molina^1, Ignasi Bartomeus^1"
date: '2022-10-26'
output:
  pdf_document:
    latex_engine: xelatex
  word_document: default
header-includes: \usepackage{float} \floatplacement{figure}{H} \usepackage{caption}
  \renewcommand{\caption}{Figure}
bibliography: library.bib
csl: journalofecol.csl
editor_options:
  markdown:
    wrap: sentence
---

\^1 Estación Biológica de Doñana (EBD-CSIC).
Sevilla, Spain.

# Abstract

1.  The stability of ecological communities over time, often quantified using its aggregated abundance or biomass, is though to be influenced by species richness and the asynchrony of the species fluctuations.
    However, the relation between community stability and the stability of the ecosystem functioning provided by this community is less explored, specially for functions involving several trophic levels such as plant pollination.
    Understanding the mechanisms driving community stability and whether this stability should be related to the stability of ecosystem functions provided is important for predicting the resilience of communities to changes in biodiversity.

2.  Using a 5-year dataset across 13 Mediterranean shrublands and X plant species, we assessed the effect of pollinator richness and asynchrony as drivers of the stability of plant's visitation rate and plants reproductive success.
    In addition, we analyzed whether the effects of species richness and visitation rate on plant reproduction success were consistent among years.

3.  The stability of plant's visitation rate is driven by the asynchrony of pollinator species abundances but not by the pollinator richness.
    In contrast, the stability of the plant reproductive success is not related to the stability of its pollinator visitation rates.
    A year by year analysis revels that plants are unlikely to be limited by pollinator abundances except in specific years.

4.  We highlight the importance of maintaining a redundancy of pollinators that visit the same plant species, given that its presence can buffer from species temporal fluctuations.
    This is particularly important for pollinators with contsarting responses to environmental fluctuations, as this creates the needed asynchrony of their populations to guarantee stable levels of flower visitation rates.
    However, we warn that more complex ecosystem functions such as reproductive success, which not only depends on pollinators, but on plant competition or resource availability, might be decoupled from primary functions (i.e. visitation rates and pollen deposition) when pollination is not a limiting factor.

# Introduction

Global environmental changes and the consequent loss of biodiversity have highlighted the need for better understanding the role of biodiversity in ecosystem function [@Hooper2005; @Lefcheck2015; @Oliver2015; @Hong2022].
We have experimental and observational evidence that biodiversity enhances aggregated community-level properties, such as total biomass [@Cardinale2006; @Cardinale2012; @Tilman2014], but the role of biodiversity for the stability of ecosystem functioning is less explored (but see @Griffin2009; @Grman2010), specially for functions involving several trophic levels such as plant pollination [@Ebeling2008; @Winfree2009a; @Garibaldi2011; @Lazaro2022].
Globally, it is estimated that at least 78% of wild plants depend to some extent on pollination by animals [@Ollerton2011].
Understanding the mechanisms driving pollinator community stability and how this relates to the stability of ecosystem functions and services delivered (i.e. pollination) is important for predicting changes in both community structure and ecosystem function.

Temporal stability is defined as the capacity of an ecosystem to dampen environmental perturbations over time while retaining ecological functions of interest [@Ives2007; @Pimm1984].
The temporal stability of a community can be influenced by the diversity of species present and the asynchrony on the species abundance fluctuations.
A higher number of species might stabilize community level functions by increasing the range of species level potential responses to environmental changes (i.e. the portfolio effect) [@McCann2000; @Tilman2006; @Hector2010; @Xu2021], although non-significant relationships between diversity and stability have also been observed [@Hooper2005; @VanderPlas2019].
Species asynchrony represents the intrinsic differences in species response to disturbances and natural fluctuations [@Loreau2013] which has been suggested as a key driver for community temporal stability [@Loreau2008].
In this sense, higher levels of species asynchrony stabilize the overall community dynamics [@Ruijven2007; @Bluthgen2016; @Craven2018].
Species asynchrony has been found to be a factor driving positive relationships between diversity and stability [@Loreau2008; @Xu2015] or even that stability is often more strongly associated with the degree of asynchrony across species than with species richness [@Bluthgen2016; @Huang2020].
Other studies have indicated that temporal stability of the dominant species or asynchrony among these dominant species is important in maintaining the stability of ecosystems [@Sasaki2011; @Valencia2020].
While community temporal stability should be related to the stability of ecosystem functions and services provided by such community, there is limited evidence linking both processes on multitrophic systems.

Since the reproductive success of most plant species highly depends on pollination by animals [@Ollerton2011], the stability of pollinator communities may increase the stability of plant reproductive success.
A greater diversity of pollinators has been shown to increase plant reproductive success as a result of complementary in service provision arising from variation of pollinator effectiveness across space and time [@Hoehn2008; @Frund2010; @Albrecht2012; @Bluthgen2011; @Frund2013; @Magrach2021].
For example, pollinator species may exhibit different ranges of daily temporal activity [@Pisanty2016; @Rader2016, @zaragoza-trello2023] and consequently may provide pollination services at different times of the day or of the season.
In any case, higher overall visitation rates are often assumed to insure reproductive success.
However, while some studies report that higher visitation rates are correlated with higher plant reproductive outputs [@Garibaldi2013; @Kaiser-Bunbury2017, @vázquez2005], other studies do not find such relationship [@Hegland2012; @Lundgren2013].
Interestingly, studies looking at pollen limitation show that higher visitation rates are often associated with no pollen limitation, indicating than above a certain threshold, changes in visitation rates are no longer relevant [Fig. 1; @Cosacov2008; @Williams2013].
However, the occurrence and magnitude of pollen limitation can vary among years for individual populations [@Burd1994; @Ashman2004], primarily because of variation in pollinator service [@Aizen2007].

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 8,fig.width=10,out.width="60%",fig.align='center', fig.cap =" 1. Conceptual figure showing the general relationship between visitation rate of pollinators and plant reproductive success to different species richness (R1, R2, ...). As the number of visits (V1, V2, ...) from pollinators increases, the plant reproductive success is expected to increase until than above a certain threshold, changes in visitation rates are no longer relevant to plant reproductive success."}
library(ggplot2)
library(patchwork)

####IB: ESTEFANIA, necesitamos un A y B en plots de abajo, para que la gente los reconozca. EN esos paneles yo escribiria Repreocution y Visitation /Richness entro. Y los paneles A y B necesitan explicación en la leyenda, de hecho, yo creo que ahora estan girados... o eso o estoy espeso. Lo hablamos por video.


#First dataset RED
s1 <- seq(from=0, to=100, by=0.5)
l1 = log(s1, base = 6)
d1 = data.frame(l1, s1)


#Second dataset BLUE
s2 <- seq(from=0, to=100, by=0.5)
l2 = log(s2, base = 8)
d2 = data.frame(l2, s2)

#Third dataset GREEN
s3 <- seq(from=0, to=100, by=0.5)
l3 = log(s3, base = 12)
d3 = data.frame(l3, s3)



to=ggplot(d1, aes(s1, l1)) +
  geom_line(color = "#e41a1c", linewidth=1.3) +
  geom_line(data =  d2, aes(s2,l2), color = "#377eb8",linewidth=1.3) +
  geom_line(data =  d3, aes(s3,l3), color = "#4daf4a",linewidth=1.3) +
  ylab("Reproductive success")+
  labs(x = "") +
  theme_classic()+
  theme(axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
  scale_x_continuous(breaks=seq(from= 0, to= 100, by = 20), labels=c("V1","V2","V3", "V4","V5","V6"))+
  theme(text = element_text(size=18,face="bold"))+
  theme(axis.ticks.x=element_blank())+
  annotate("rect", xmin = c(0, 60), xmax = c(20,80), ymin = c(0.4, 1.35), 
           ymax = c(1.75, 2.7), linetype = 1, fill="gray88", alpha=0.3, colour = "black") +
  annotate("text", x = c(98, 98,98), y = c(2.67, 2.31,1.95), label = c("R3", "R2", "R1"), size=5)+
  annotate("text", x = c(1.25, 61.3), y = c(1.62,2.58), label = c("A", "B"), size=6)+
  theme(axis.line.x = element_line(arrow = arrow()))+
  theme(axis.line.y = element_line(arrow = arrow()))



##################################
x <- seq(0, 41, by = 0.1)
y1 <- sin(x)
y1.2 <- cos(x+4.3)

da1 <- data.frame( x, y1)
da1.2 <- data.frame( x, y1.2)

R_1=ggplot(da1, aes(x, y1))+
  geom_line( size=1) +
  geom_line(data =  da1.2, aes(x, y1.2), color = "#e41a1c",size=1)+
  theme_classic() +
  xlab("Time") +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) + 
  scale_y_continuous(breaks=seq(from= -1, to= 1, by = 2), labels=c("R1","R3"))+
  theme(text = element_text(size=15, face="bold"))+
  theme(axis.title.y = element_blank()) +
  annotate("text", x = 44, y = 0.4, label = "Rep", size=4,color="#e41a1c")+
  annotate("text", x = 43, y = 0, label = "R", size=4)+ 
  theme(aspect.ratio=0.5)



###################################

x2 <- seq(0, 41, by = 0.1)
y2 <- sin(x2)
y3 = sin(x2/2.5)

da2 <- data.frame(x2, y2)
da2.1 = data.frame(x2,y3)

v_1=ggplot(da2, aes(x2, y2))+
  geom_line( size=1) +
  geom_line(data =  da2.1, aes(x2,y3), color = "#e41a1c",size=1)+
  theme_classic() +
  xlab("Time")+
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+ 
  scale_y_continuous(breaks=seq(from= -1, to= 1, by = 2), labels=c("V1","V2"))+
  theme(text = element_text(size=15, face="bold"))+
  theme(axis.title.y = element_blank())+
  annotate("text", x = 44, y = -0.5, label = "Rep", size=4, color="#e41a1c")+
  annotate("text", x = 42.5, y = 0, label = "V", size=4) + 
  theme(aspect.ratio=0.5)


po1=v_1/R_1


######################
x3 <- seq(0, 57, by = 0.1)
y3 <- sin(x3)
y3.1 <- cos(x3+4.3)

da3 <- data.frame(x3, y3)
da3.1 <- data.frame(x3, y3.1)

v_2=ggplot(da3, aes(x3, y3))+
  geom_line( size=1) +
  geom_line(data =  da3.1, aes(x3,y3.1), color = "#e41a1c",size=1)+
  theme_classic() +
  xlab("Time") +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) + 
  scale_y_continuous(breaks=seq(from= -1, to= 1, by = 2), labels=c("V4","V5"))+
  theme(text = element_text(size=15, face="bold"))+
  theme(axis.title.y = element_blank()) +
  annotate("text", x = 61, y = 0, label = "Rep", size=4,color="#e41a1c")+
  annotate("text", x = 59, y = 0.3, label = "V", size=4)+ 
  theme(aspect.ratio=0.5)




########################################
x4 <- seq(0, 57, by = 0.1)
y4 <- sin(x4)
y5 = sin(x4/2.5)


da4 <- data.frame(x4, y4)
da5 = data.frame(x4,y5)

R_2=ggplot(da4, aes(x4, y4))+
  geom_line( size=1) +
  geom_line(data =  da5, aes(x4,y5), color = "#e41a1c",size=1)+
  theme_classic() +
  xlab("Time")+
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+ 
  scale_y_continuous(breaks=seq(from= -1, to= 1, by = 2), labels=c("R1","R3"))+
  theme(text = element_text(size=15, face="bold"))+
  theme(axis.title.y = element_blank())+
  annotate("text", x = 61, y = -0.6, label = "Rep", size=4, color="#e41a1c")+
  annotate("text", x = 59, y = 0.4, label = "R", size=4)+ 
  theme(aspect.ratio=0.5)


po2=v_2/R_2


to/ (po1 |po2)
```

Here, we use a 5-year dataset collected for a total of 12 plant species across 13 Mediterranean shrubland sites.
However, to study the role of pollinator richness and asynchrony as drivers of stability of its visitation rates we only use the 5 most represented plant species across years and sites.
Further, we evaluate whether more stable pollinator communities foster a more stable plant reproductive success along years, measuring both the stability of fruit and seed set.
We expect that the stability of visitation rates will increase with higher richness and asynchrony of pollinators.
In addition, a greater stability of plant reproductive success is expected with higher stability of visitation rates.
However, given the lack of a clear relationship between pollinator and plant reproductive output stability, we further analyzed the variability on the yearly effect of pollinator richness and visitation rate on the reproductive success of the plants.

# Material and method

Our study was conducted in the southwest of the Iberian Peninsula (Huelva and Sevilla - Spain).
We selected 13 sites in Mediterranean shrub ecosystems that ranged from sites with little to no disturbances to more modified ones with crops and urban areas nearby.
These sites are similar in the plant community composition and the most abundant plant species are known to be attractive to flower visitors and to depend on pollinators to maximize its reproduction (e.g. dominated by *Cistus crispus*, *Cistus ladanifer*, *Cistus salviifolius*, *Halimium halimifolium*, and *Lavandula pedunculata*).
Each site was surveyed at least 7 times per year during the flowering season from 2015 to 2019 (from March to June).
Within each site, we selected 3-4 individuals belonging to 3-9 plant species (mean ± standard error: 5.92 ± 0.54 plant species per site).
We performed focal observations where all the floral visitors (from now on referred to as pollinators) that contacted with their flowers were registered.
Only pollinators that could not be identified in the field were captured, stored, and identified to species level in the laboratory.
For each plant individual, we counted the total number of flowers observed in each survey and at the end of the season, we recorded the number of fruits developed / aborted and the number of seeds per fruit in a subsample of 3 fruits.
Focal observations had a duration of five minutes per individual in 2015-2016 and three minutes from 2017 to 2019.
Hence, for each plant individual, the sampling effort was standardized to the number of visits per flower per minute.
To that end, we divided the total visits observed by the number of flowers observed and by the total observation time (time of each observation multiplied by number of survey rounds per year).
Pollinator richness is calculated as the number of pollinator species observed visiting the plant, fruit set as the proportion of fruits developed, and the seed set as the mean number of seeds per fruit for each plant individual sampled per site.

## Stability

We analyze five plant species (*Cistus crispus*, *Cistus ladanifer*, *Cistus salviifolius*, *Halimium halimifolium*, and *Lavandula pedunculata*) that were recorded in at least 5 sites in a minimum of two years per site.
The stability of pollinator visitation rates was quantified as the inverse of the coefficient of variation (mean/SD) for each plant species in each plot following Tilman, 1999.
This is an adequate index given that in our dataset the mean and the variance scale with each other.
To examine the role of richness and synchrony of pollinator species abundances as drivers of stability of visitation rate, we calculate the richness as the total number of pollinator species that visit each plant species in each plot.
The synchrony index for each plant species in the plot was calculated following Loreau and de Mazancourt (2008), as: $$
\begingroup\Large
\phi =\frac{\sigma_{x_T}^2}{(\sum_{i=1}^S\sigma_{x_i})^2}
\endgroup
$$ where ${\sigma_{x_T}^2}$ is the variance of the community abundance of each plot and ${\sigma_{x_i}}$ is the standard deviation of species i abundance in a community with S species.
This synchrony measurement varies from zero, when fluctuations are perfectly asynchronous, to one, when fluctuations are perfectly synchronous [@Loreau2008].
Finally, we express asynchrony as $1-\phi$.
We also calculated the stability of fruit proportion and of the seed number for each plant species in each plot.

## Statistical analysis

To discover the main drivers of visitation rate stability on the five plant species studied, we carried out two linear mixed models using as response variable the stability of visitation rate and as explanatory variables pollinator asynchrony and richness, respectively.
Similarly, linear mixed model was used to test the influence of pollinator richness on asynchrony of pollinator species abundances.
In all cases, site and plant species were included as random factor.
For a deeper understanding of the processes stabilizing visitation rate, we also analyzed the response for each plant species separately.

To study whether the stability of pollinator visitation rate influenced in the stability of the plant reproductive success, we run linear mixed models using as response variables the stability of fruit proportion or the stability of seed number and as explanatory variable the visitation rate stability.
Site and plant species were included as random factors.

Finally, we further analyzed the variability on the yearly effect of pollinator richness and visitation rate on the reproductive success of the plants.
For this we employed all plant species sampled and we analyzed the interactive effect between richness and year, and between visitation rate and year on fruit proportion using a binomial generalized linear mixed model, and on the number of seeds employing a linear mixed model.
*P* values were obtained using the type III Anova (package: car CITAR) as recomended for tetsing interactions.
The number of seeds per fruit was centered and scaled per plant species to allow meaningful comparisons across species.
For all models, we included plant species identity nested within site and site as random effects because of multiple individuals of the same plant species are measured at each site.

All the analyses of this study were conducted in R software (v. 4.0.2; R Core Team, 2022) and the lme4 (Bates et al., 2015) and ggplot2 (Wickham, 2016) packages.
DHARMa package was employed for checking all models (Harting 2017)

# Results

## Stability of visitation rate and its drivers: richness and asynchrony

Stability of visitation rates ranged from 0.64 to 9.24 (mean ± SE: 1.928 ± 0.232), whereas pollinator richness ranged from 2 to 20 species (8.128 ± 0.686) and the pollinator asynchrony varied from 0 to 0.998 (0.754 ± 0.032).
There is a strong positive relationship between stability of visitation rates and asynchrony of pollinator species abundances with greater visitation rate stability when pollinator asynchrony increases [(Estimate ± standard error: 2.903 ± 1.134; *p* = 0.017) (Fig 2A)](Virginia%20me%20ha%20comentado%20en%20reportar%20el%20R2%20de%20los%20modelos%20pero%20al%20tratarse%20de%20modelos%20mixtos%20tendriamos%20que%20poner%20el%20marginal%20o%20el%20condicional.He%20revisado%20articulos%20que%20utilizan%20estos%20modleos%20y%20normalmente%20no%20ponen%20R2.%20Lo%20incluyo??), whereas stability of visitation rate was not influenced by the pollinator richness (-0.001 ± 0.063; *p* = 0.986) (Fig 2B).
We also found a positive relationship between asynchrony and pollinator richness (0.020 ± 0.005, *p* = 0.001) (Fig 2C).
Furthermore, we observed one data point has a high leverage on the stability analysis (*C.crispus*, Fig 2A-B), when we remove this point, although the relationship is not significant, the tendency is still positive (0.968 ± 0.745; *p* = 0.215).

When we analysed each plant species separately, we observed positive relationship between asynchrony of pollinators and stability of visitation rate for *C. crispus*, *H. halimifoliun* and *L. pedunculata*, weak relationship for *C. salviifolious* and a weak negative relationship for *C.ladanifer*.
For the relationship with pollinator richness, *C. crispus*, *C. ladanifer* and *C. salviifolius* showed a negative relationships while *H. halimifolium* and *L. pedunculata* showed positive relationships, explaining the overall lack of relationship across all five plants (Supplementary material-Fig 1).

```{r, echo=FALSE, warning=FALSE,message=FALSE,fig.height = 8,fig.width=20, out.width="100%",fig.align='center', fig.cap =" 2.Relationships between stability of visitation rate (calculated as the inverse of the coefficient of variation) and asynchorny of pollinators (Loreau and de Mazancourt’s index) (A), stability of visitation rate and pollinator richness (B), and asynchorny of pollinators and richness (C).Dots represent the different plant species incluided in the analysis.Significant models are representing with solid line."}

library(tidyverse)
library(lme4)
library(effects)
library(patchwork)


# staility of visitation rate and richness and asynchrony
# plant species present at least in five sites
# C.crispu, C. ladanifer, C. salviifolius, H.halimifolium and L. pedunculata

# stability data 
data_plant<- read.csv("../Data/Stability.csv")
data_plant<-data_plant[,-1]


# eliminar plant species 
sp_out2=data_plant %>%
  group_by(Plant_gen_sp) %>%
  summarise(Unique_Id = n_distinct(Site_ID)) %>%
  filter(Unique_Id <= 4) %>%
  select(Plant_gen_sp) %>% pull(Plant_gen_sp)

#Data with species in at least 5 sites
data_plant = data_plant %>% filter(!Plant_gen_sp %in% sp_out2)


data_plant=data_plant %>%
  filter(!Plant_gen_sp=="Salvia rosmarinus") %>%
  filter(!Plant_gen_sp=="Halimium calycinum")%>%
  filter(!Plant_gen_sp=="Lavandula stoechas")



## Replace Inf and -Inf with NA
data_plant[is.na(data_plant) | data_plant == "Inf"] <- NA 
data_plant[is.na(data_plant) | data_plant == "-Inf"] <- NA 



# We can express asynchrony as 1 - φ, 
#where φ is Loreau and de Mazancourt’s (2008)
data_plant$asyn_LM= 1-data_plant$syncLM


#model 
mod1_sta= lmer (cv_1_visitation ~ asyn_LM + (1|Site_ID) + (1|Plant_gen_sp), data = data_plant)



#getting effects for asynchrony
effe_mod_sta <-data.frame( effect("asyn_LM", mod1_sta, se = TRUE))


#plot model of asynchrony
p1=ggplot(effe_mod_sta, aes(asyn_LM, fit)) + geom_line(size=1)+
  geom_ribbon(aes(ymin = lower, ymax = upper),alpha=0.2)+
  scale_y_continuous(limits = c(-2.5, 9.5))+labs(color='Plant species')+
  geom_point(data = data_plant, aes(x =  asyn_LM, y = cv_1_visitation, color=Plant_gen_sp), alpha=0.7,size=6)+
  scale_colour_brewer(palette = "Set1")+
   theme_bw ()+
  labs(x = "Asynchrony of pollinator",y="Stability of visitation rate")+
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))



#model richness
mod1.2_sta= lmer (cv_1_visitation ~ S_total + (1|Site_ID) + (1|Plant_gen_sp), data = data_plant)


#getting effects for richness
effe2_mod_sta <-data.frame( effect("S_total", mod1.2_sta, se = TRUE))



#plot model of richness
p2=ggplot(effe2_mod_sta, aes(S_total, fit)) + geom_line(size=1,linetype = "dashed")+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha=0.1)+
  scale_y_continuous(limits = c(-2.5, 9.5))+  labs(color='Plant species')+
  geom_point(data = data_plant, aes(x =  S_total, y = cv_1_visitation, color=Plant_gen_sp), alpha=0.7,size=6)+
  scale_colour_brewer(palette = "Set1")+
  theme_bw ()+
  labs(x = "Richness of pollinator",y="Stability of visitation rate") +
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))
  

# relationship between richness and asynchrony
mod_rich_asyn= lmer (asyn_LM ~ S_total +  (1|Site_ID) + (1|Plant_gen_sp), weights = asyn_LM, data = data_plant)

#getting effects for richness
effe_rich_mod_sta <-data.frame( effect("S_total", mod_rich_asyn, se = TRUE))
#plot model 
p1.2=ggplot(effe_rich_mod_sta, aes(S_total, fit)) + geom_line(size=1)+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha=0.2)+
  labs(color='Plant species')+
  geom_point(data = data_plant, aes(x =  S_total, y = asyn_LM, color=Plant_gen_sp), alpha=0.7,size=6)+
  scale_colour_brewer(palette = "Set1")+
  theme_bw ()+
  labs(x = "Richness of pollinator",y="Asynchrony of pollinator")+
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))
  



#join plots
p_cv_visit=p1+p2+ p1.2+
  plot_annotation(tag_levels = "A")& 
  theme(plot.tag.position = c(0, 1),
        plot.tag = element_text(hjust = -0.1,vjust=0.5, size=25))& 
  theme(legend.position = "bottom",legend.background = element_blank(),legend.box.background = element_rect(colour = "black"))&theme(text = element_text(size=25))
p_cv_visit+ plot_layout(guides = "collect")

```

## Stability of visitation rate and stability of the plant reproductive success

Stability of fruit proportion varied from 2.62 to 120.66 (mean ± SE: 19.806 ± 3.615), whereas the stability of seed number ranged 1.28 to 55.86 (7.018 ± 1.441).
When we analyzed whether the stability of the pollinator's visitation rate affected the stability of the plant reproductive success, we did not find a clear relationship when analyzing the fruit proportion (Estimate ± standard error: -1.547 ± 2.611; *p* = 0.558) (Fig 3A).
However, contrary to expected, the stability of seed number did show a negative relationship with the stability of pollinator's visitation rate (-1.887 ± 0.959; *p* = 0.061) (Fig 3B).
Although this tendency is influenced by a high value in the stability of seed number of *H. halimifolium* (Fig 3B) since when we removed this point the relationship disappears (0.561 ± 0.535; *p* = 0.306).

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 10,fig.width=20,out.width="80%",fig.align='center', fig.cap = " 3. Relationship between stability of plant reproductive succes: fruit propotion (A) and seed number (B) and the stability of visitation rate. Dots represent the different plant species incluided in the analysis.Significant models are representing with solid line."}

#model fruit stability ~ visitation rate stability
mod2_sta= lmer(cv_1_fruit ~ cv_1_visitation + (1|Plant_gen_sp)+(1|Site_ID), data = data_plant)

#getting effects 
effe3_mod_sta <-data.frame( effect("cv_1_visitation", mod2_sta, se = TRUE))


#plot model 
p_mod2=ggplot(effe3_mod_sta, aes(cv_1_visitation, fit)) + geom_line(size=1,linetype = "dashed")+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha=0.1)+
  geom_point(data = data_plant, aes(x =  cv_1_visitation, y = cv_1_fruit, color=Plant_gen_sp),alpha=0.7, size=7)+
  labs(color='Plant species')+
  scale_colour_brewer(palette = "Set1")+
  labs(y = "Stability of fruit proportion",x="Stability of visitation rate")+
  theme_bw ()+
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))





# model seed stability ~ visitation rate stability
mod3_sta= lmer(cv_1_seed ~ cv_1_visitation + (1|Plant_gen_sp)+(1|Site_ID), data = data_plant)


#getting effects 
effe4_mod_sta <-data.frame( effect("cv_1_visitation", mod3_sta, se = TRUE))


#plot model 
p_mod3=ggplot(effe4_mod_sta, aes(cv_1_visitation, fit)) + geom_line(size=1)+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha=0.2)+
  labs(color='Plant species')+
  geom_point(data = data_plant, aes(x =  cv_1_visitation, y = cv_1_seed, color=Plant_gen_sp), alpha=0.7,size=7)+
  scale_colour_brewer(palette = "Set1")+
  labs(y = "Stability of seed number",x="Stability of visitation rate")+
  theme_bw ()+
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))



#join plots
p_plant=p_mod2+p_mod3+ 
  plot_annotation(tag_levels = "A")& 
  theme(plot.tag.position = c(0, 1),
        plot.tag = element_text(hjust = -0.8, vjust = 0.5,size=30))& 
  theme(legend.position = "bottom",legend.background = element_blank(),legend.box.background = element_rect(colour = "black"))&theme(text = element_text(size=30))
p_plant+ plot_layout(guides = "collect")

```

## The effect of pollinators on reproductive success depends on the year

To analyse whether the variability of pollinator richness and visitation rate across years affected the reproductive success of plants we used all plant species sampled.
When we analysed the fruit proportion (set? unify terminology), we found that the interaction between year and pollinator richness, and year and visitation rate affected the fruit proportion (richness and year: $\chi 2$ = 28.976, df = 4, *p* = \<0.0001; visitation rate and year: $\chi 2$ = 40.691, df = 4, *p* = \<0.0001).
Furthermore, we observed a significant effect of year by itself, but not so of pollinator richness or visitation rate.
Although we observed a general saturation of the proportion of fruits developed with most species consistently over 80% of fruit set, in years like 2017 we found that a greater richness and visitation rate increased the fruit proportion.
We also observed a positive relationship between richness and fruit proportion in 2019.
However in 2018, the relationship between richness and fruit proportion was negative (Fig 3).
[esto requiere un poco más de story telling.Por ejemplo, estos años son años altos o bajos en polinizadores?](con%20los%20datos%20que%20tenemos%20la%20riqueza%20y%20la%20tasa%20de%20visitas%20es%20similar%20en%20los%20diferentes%20años.%20Tambien%20he%20mirado%20datos%20meteorologicos%20descargados%20de%20la%20estacion%20de%20Almonte-precipitacion,%20radiacion,%20humedad%20y%20temperatura,y%20no%20parace%20que%20haya%20diferencias%20entre%20años)

For the seed number analysis, we found an effect of year in both models in addition to the interaction between visitation rate and year ($\chi 2$ = 9.113, df = 4, *p* = 0.058) but not the interaction between pollinator richness and year ($\chi 2$ = 2.592, df = 4, *p* = 0.628).
We observed that a higher visitation rate increased the seed number in 2019 (Supplementary material-Fig 2).

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height =13,fig.width=30,out.width="100%", fig.align='center',fig.cap=" 4. Interaction effect between richness and year (top row), and visitation rate and year (bottom row) on fruit proportion. For the visualization purpose, we omit in the visitation rate (x-axis) the values outside of the 95\\%."}

##IB: Yo cortaba todos los plots a zero (o a -1) El de arriba tambien.

Pollinator_Plant<- read.csv("../Data/Pollinator_Plant.csv") #400 observaciones
Pollinator_Plant<-Pollinator_Plant[,-1]
Pollinator_Plant$Year= as.factor(Pollinator_Plant$Year)
Pollinator_Plant$Site_ID= as.factor(Pollinator_Plant$Site_ID)
Pollinator_Plant$Plant_gen_sp= as.factor(Pollinator_Plant$Plant_gen_sp)


# species out
#plant species that for each year occur only at one site
spp_out <- Pollinator_Plant %>%
  group_by(Plant_gen_sp, Year) %>%
  summarise(Unique_Id = n_distinct(Site_ID)) %>%
  filter(Unique_Id == 1) %>%
  select(Plant_gen_sp, Year)


Pollinator_Plant= anti_join(Pollinator_Plant, spp_out)



# model 1
mod1_to= glmer(cbind(fruit_formado, Fruit_No) ~ S_total * Year + (1|Site_ID/Plant_gen_sp),family=binomial,data=Pollinator_Plant)

#getting effects for the two variables
ee_mod1 <- as.data.frame(Effect(c("S_total","Year"),mod = mod1_to))

p1=ggplot(ee_mod1, aes(S_total,fit))+
  geom_line(size=0.8)+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)+
  geom_point(data= Pollinator_Plant, aes(x = S_total , y = fruit_proportion),shape=21, fill="grey", size=6)+
  labs(x = "Pollinator richness",y="Fruit proportion")+
  facet_wrap(~Year, nrow = 1) + 
  theme_bw ()+
  theme(legend.position = "none")



# model 2
mod2_to= glmer(cbind(fruit_formado, Fruit_No) ~ visitatio_rate * Year + (1|Site_ID/Plant_gen_sp),family=binomial,data=Pollinator_Plant)

#getting effects for the two variables
ee_mod2 <- as.data.frame(Effect(c("visitatio_rate","Year"),mod = mod2_to))

p2=ggplot(ee_mod2, aes(visitatio_rate,fit))+
  geom_line(size=0.8)+  
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)+
  geom_point(data= Pollinator_Plant, aes(x =visitatio_rate , y = fruit_proportion),shape=21, fill="grey", size=6)+
  labs(x = "Visitation rate",y="Fruit proportion")+
  facet_wrap(~Year, nrow = 1) + 
  coord_cartesian(xlim=c(0, quantile(Pollinator_Plant$visitatio_rate,0.95)))+
  theme_bw ()+
  theme(legend.position = "none")


p1/p2&theme(text = element_text(size=35))


```

# Discussion

We show that pollinator's visitation rate stability increase with higher asynchrony of pollinators species abundances and that greater species richness only increase stability of visitation rate indirectly, via enhanced species asynchrony [IB: esto a abstract!]
.
However, contrary to expectations, we found no relationship between the stability of visitation rates and the stability of plant reproductive success.
This is because in our study system, plant reproduction is not pollinator limited in most years, with most plants reaching maximum reproductive success even in the sites with [lower pollinator abundances.](quizas%20decir%20lower%20richness%20and%20visitation%20rate??)
However, this do not imply that pollinators are not important or that are always in enough numbers to disregard them, because for specific years the relationship between pollinator activity and plant's reproductive output kicks in as important.[seria ideal decir quales... los que tienen poco polinizador? Los secos, quizas?](los%20años%20no%20tienen%20menor%20actividad%20ni%20riqueza%20de%20polinizadores,%20tampoco%20son%20los%20años%20mas%20secos,%20no%20se%20ven%20diferencias%20en%20precipitacion,%20temperatura,%20humedad%20o%20radiacion)
When and where pollinators are limiting is the key question then.

While drivers of temporal stability have been well study in plant communities [@Ruijven2007; @Gross2014; @Craven2018; @Leps2018; @Sasaki2019; @Valencia2020; @Kigel2021], relatively few studies have evaluated how this same drivers can affect community stability in mobile organisms such as pollinators [@Ebeling2008; @Senapathi2021; @Lazaro2022].
A first outcome of our analysis is that asynchrony of species abundances is a key driver of visitation rate stability.
This stability-asynchrony relationship has been found by different theoretical and empirical studies [@DeMazancourt2013; @Bluthgen2016; @Leps2018; @Sasaki2019; @Valencia2020; @Kigel2021].
For example, Lázaro et al.(2022) also found for plants, pollinators and their interactions that more asynchronous communities being more temporal stable.
In this sense, species asynchrony can increase temporal stability of visitation rate when the abundance of one species increases as a result of decreases in the abundance of another species (i.e. density compensation [@Winfree2009a; @Mukherjee2019]); or also when they respond differently to the same environmental changes (i.e. response diversity [@Walker99; @Winfree2013]).
[Aunque nosotros no sabemos si estos cambios son debido a perturbaciones ambientales, We believe it is important to test the degree to which these stabilizing mechanisms are at work.](Quizas%20añadir%20algo%20asi??)

On the other hand, species richness is considered one of the strongest drivers of community stability in plants [@Tilman2006; @Hallett2014], although Valencia et al. (2020), analyzing a large number of plant community datasets, have reported that this relationship is not as strong.
Pollinator studies carried out in crop systems have observed a positive relationship between species richness and stability of floral visits [@Ebeling2008] or stability of abundance and richness [@Senapathi2021].
However, our results show that pollinator richness was positively associated with asynchrony, which might positively affect the stability of visitation rate, but indirectly.
Species richness may increase the probability that community contains species with different responses to environmental conditions and perturbations, leading to asynchrony (compensation) among species abundance and thus, to an increase in community stability [@Craven2018; @McCann2000; @Yachi1999].

Despite the stability is crucial to the sustainability of ecosystem functions, relatively few studies have evaluated the stability of the pollinator visits frequency on pollination services, and those who did used agricultural systems [@Garibaldi2011; @Garibaldi2013; @Lazaro2019; @Hunicken2021].
To the best of our knowledge, how the stability of pollinator community affect to the reproductive success of the wild plant community remaining largely unknown.
In pollinator-dependent crops it has been observed that a greater yield stability is related to pollinator diversity and the stability of visitation rates [@Garibaldi2011; @Garibaldi2013; @Hunicken2021] but in our study system (wild plants), we did not find this relationship.
However, we observed that in specific years a higher visitation rate or richness of pollinators increases the proportion of fruits, even if there is a saturation of the proportion of fruits in most of the plant species analysed.
As the number of pollinator visits received by a plant increases from zero, the reproductive success of the plant is expected to rise initially but then to level off or possibly decline [@Young1992; @Morris2010].
Bees can remove 70--80% of the pollen that is presented in a flower and a flower's pollen can be exhausted after only a few visits.
Therefore, its reproductive success may not continue to increase with increased visitation, but instead may saturate quickly because of pollen depletion [@Thomson2001].
Even so, in certain years, the pollinator activity (visitation rate and richness) increases the fruit proportion.\

One possible explanation for this is that there was greater floral diversity and abundance in the plots these years, [although we have not measured this directly in the plots](quiero%20decir%20que%20nosotros%20no%20sabemos%20si%20esos%20años%20los%20plots%20tenian%20mas%20abundancia%20y%20diversidad%20de%20flores,%20recursos%20disponibles,%20nosotros%20tenemos%20las%20flores%20de%20las%20especies%20analizadas%20pero%20no%20del%20resto).
These factors can mediate pollination through impacts on pollinator densities [@Steffan-Dewenter2008a; @Williams2015], foraging dynamics [@Kunin1996], visitation rates [@VanNuland2013; @Veddeler2006], and pollen deposition [@Lortie1999; @Evans2017].
The concentration effect, which occurs when foragers visit a location in greater numbers due to high resource availability [@Kunin1996; @Totland1998], has an impact on the reproductive success of plants [@Blaauw2014; @Cohen2021].
Furthermore, some plant species increase pollinator visits to the coflowering plant, which subsequently contributes to the reproductive success of neighbouring individuals [@Schemske1981; @Moeller2004; @Ghazoul2006].
Another possible explanation to this might be the variations in abiotic factors.
Since the weather conditions can vary significantly between years, the abundance of pollinators during the flowering season of a plant can show annual variations, which may have an impact on the plant reproductive success [@Vicens2000; @Ivey2003].
In addition, the environmental conditions also affect to host plants.
For instance, the variation of temperature conditions lead to alterations in nectar production, composition and concentration [@Pacini2003], which can affect to the pollinator activity.
Although we have not taken these factors into account in our study, we believe it is important to include them in order to better understand the relationships between pollinators and plant reproductive success over time.

In summary, our study highlights the importance of pollinator species' asynchrony in maintaining the temporal stability of these communities in natural environments.
However, this stability did not contribute to the stability of the function.
In this sense, we believe that further studies are needed to better understand these mechanisms in natural communities by assessing the reproductive success of a wider variety of plant species.
The variations seen between years suggest that in our study system, plant reproduction is not typically limited by pollinators.
However in certain years the relationship between pollinator activity and plant reproductive success is important.
This study contributes to understanding the mechanisms driving the temporal stability of pollinator communities in natural systems and how the relationships between pollinators and plant reproductive success may vary from year to year.

\newpage

# Supplementary material

```{r, echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=30,out.width="100%", fig.align='center',fig.cap=" 1. Changes in the stability of visitation rate with the asynchrony (top row) and richness (botton row) are shown for each plant species"}
# model plot (cv_1_visitation~S_total+asynchrony)


# plot for richness
plot_stabi_plant <- data_plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(cv_1_visitation~S_total,data))) %>%
  mutate(mod1 = list(ggeffects::ggpredict(mod, terms = "S_total"))) %>%
  mutate(plots = list(ggplot(mod1, aes(x, predicted)) + geom_line(size=1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), linetype = 3, alpha=0.2, colour = "black")))

#Cistus crispus
p1=plot_stabi_plant$plots[[1]] + geom_point(data =data_plant %>% filter(Plant_gen_sp == "Cistus crispus"), 
  aes(x =  S_total, y = cv_1_visitation),color="#e41a1c", alpha=0.7,size=7)+ 
  labs(x = "",y="Stability of visitation rate")+scale_x_continuous(limits = c(9, 16))+
  scale_y_continuous(limits = c(-5,9.5))+
  theme_bw ()


#Cistus ladanifer
p2=plot_stabi_plant$plots[[2]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus ladanifer"), 
  aes(x =  S_total, y = cv_1_visitation),color="#377eb8",alpha=0.7, size=7)+ 
  labs(x = "",y=NULL)+scale_x_continuous(limits = c(3, 16))+ 
  scale_y_continuous(limits = c(-1.55,4))+
  theme_bw()

#Cistus salviifolius
p3=plot_stabi_plant$plots[[3]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus salviifolius"), 
  aes(x =  S_total, y = cv_1_visitation),color= "#4daf4a",alpha=0.7, size=7)+ 
  labs(x = "Richness",y=NULL)+scale_x_continuous(limits = c(3, 20))+  
  scale_y_continuous(limits = c(-3,6))+
  theme_bw()


#Halimium halimifolium
p4=plot_stabi_plant$plots[[4]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Halimium halimifolium"), 
  aes(x =  S_total, y = cv_1_visitation), color= "#984ea3",alpha=0.7, size=7)+   labs(x = "",y=NULL)+ scale_x_continuous(limits = c(4, 14))+ 
  scale_y_continuous(limits = c(-0.7,3))+
  theme_bw()


#Lavandula pedunculata
p5=plot_stabi_plant$plots[[5]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Lavandula pedunculata"), 
  aes(x =  S_total, y = cv_1_visitation),color="#ff7f00",alpha=0.7, size=7)+ 
  labs(x = "",y=NULL)+  
  scale_y_continuous(limits = c(-0.7,4.7))+
  theme_bw()




# model plot for asynchrony
plot_stabi_plant_2 <- data_plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(cv_1_visitation~asyn_LM,data))) %>%
  mutate(mod1 = list(ggeffects::ggpredict(mod, terms = "asyn_LM"))) %>%
  mutate(plots = list(ggplot(mod1, aes(x, predicted)) + geom_line(size=1) +
 geom_ribbon(aes(ymin = conf.low, ymax = conf.high),linetype = 3, alpha=0.2, colour = "black")))


#Cistus crispus
p1.1=plot_stabi_plant_2$plots[[1]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus crispus"), 
  aes(x =  asyn_LM, y = cv_1_visitation),color="#e41a1c",alpha=0.7, size=7)+ 
  labs(x = "",y="Stability of visitaion rate",subtitle = "Cistus crispus")+
  scale_y_continuous(limits = c(-5,9.5))+
   theme_bw()+theme( plot.subtitle = element_text(face = "italic"))


#Cistus ladanifer
p2.1=plot_stabi_plant_2$plots[[2]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus ladanifer"), 
  aes(x =  asyn_LM, y = cv_1_visitation),color="#377eb8", alpha=0.7,size=7)+ 
  labs(x = "",y=NULL,subtitle = "Cistus ladanifer")+ 
  scale_y_continuous(limits = c(-1.55,4))+
  theme_bw()+theme( plot.subtitle = element_text(face = "italic"))


#Cistus salviifolius
p3.1=plot_stabi_plant_2$plots[[3]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus salviifolius"), 
  aes(x =  asyn_LM, y = cv_1_visitation),color= "#4daf4a",alpha=0.7, size=7)+ 
  labs(x = "Asynchrony of pollinators",y= NULL,subtitle = "Cistus salviifolius")+ 
  scale_y_continuous(limits = c(-3,6))+
  theme_bw()+theme( plot.subtitle = element_text(face = "italic"))


#Halimium halimifolium
p4.1=plot_stabi_plant_2$plots[[4]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Halimium halimifolium"), 
  aes(x =  asyn_LM, y = cv_1_visitation), color= "#984ea3", alpha=0.7,size=7)+   labs(x = "",y=NULL,subtitle = "Halimium halimifolium")+ 
  scale_y_continuous(limits = c(-0.7,3))+
  theme_bw() +theme( plot.subtitle = element_text(face = "italic"))


#Lavandula pedunculata
p5.1=plot_stabi_plant_2$plots[[5]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Lavandula pedunculata"), 
  aes(x =  asyn_LM, y = cv_1_visitation), color="#ff7f00",alpha=0.7, size=7)+ 
  labs(x = "",y=NULL,subtitle = "Lavandula pedunculata")+  
  scale_y_continuous(limits = c(-0.7,4.7))+
  theme_bw() +theme( plot.subtitle = element_text(face = "italic"))



#join plot
p1.1+p2.1+p3.1+p4.1+p5.1+p1+p2+p3+p4+p5+plot_layout(ncol = 5)& theme(axis.title = element_text(face="bold"))&theme(text = element_text(size=30))


```

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=30,out.width="100%", fig.align='center',fig.cap=" 2. Interaction effect between richness and year (top row), and visitation rate and year (bottom row) on seed number. For the visualization purpose, we omit in the visitation rate (x-axis) the values outside of the 95\\%."}

# #scale seed number variable
Pollinator_Plant=Pollinator_Plant %>% 
  group_by(Plant_gen_sp) %>%
  mutate(seed_sc=scale(Seeds, center = T, scale = T))

#model3
mod3_to= lmer(seed_sc ~S_total * Year + (1|Site_ID/Plant_gen_sp),data=Pollinator_Plant)

#getting effects for the two variables
ee_mod3 <- as.data.frame(Effect(c("S_total","Year"),mod = mod3_to))

p3=ggplot(ee_mod3, aes(S_total,fit))+
  geom_line(size=0.8)+ 
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)+
  geom_point(data= Pollinator_Plant, aes(x = S_total , y = seed_sc),shape=21, fill="grey", size=6)+
  labs(x = "Pollinator richness",y="Seed number")+
  ylim(-3,3)+
  facet_wrap(~Year, nrow = 1) + 
  theme_bw ()+
  theme(legend.position = "none")

#model4
mod4_to= lmer(seed_sc ~ visitatio_rate*Year + (1|Site_ID/Plant_gen_sp),data=Pollinator_Plant)


#getting effects for the two variables
ee_mod4 <- as.data.frame(Effect(c("visitatio_rate","Year"),mod = mod4_to))

#plot

p4 = ggplot(ee_mod4, aes(visitatio_rate,fit))+
  geom_line(size=0.8)+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)+
  geom_point(data= Pollinator_Plant, aes(x =visitatio_rate , y = seed_sc),shape=21, fill="grey",size=6)+
  labs(x = "Visitation rate",y="Seed number")+
  facet_wrap(~Year, nrow = 1) + 
  coord_cartesian(xlim=c(0, quantile(Pollinator_Plant$visitatio_rate,0.95)),ylim = c(-3,3))+
  theme_bw ()+
  theme(legend.position="none")

p3/p4 &theme(text = element_text(size=35))

```

# References
