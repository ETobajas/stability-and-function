---
title: "The temporal stability in flower visitation rates is driven by the asynchrony of pollinator abundances but does not necessarily explain plant reproductive success stability."
author: "Estefanía Tobajas^1, Virginia Domínguez-García^2, Francisco P. Molina^2, Ignasi Bartomeus^2"
date: '2022-10-26'
output:
  word_document: default
  pdf_document:
    latex_engine: xelatex
header-includes: \usepackage{float} \floatplacement{figure}{H} \usepackage{caption}
  \renewcommand{\caption}{Figure}
bibliography: library.bib
csl: journalofecol.csl
editor_options:
  markdown:
    wrap: sentence
---

\^1 Departamento de Biología Animal, Facultad de Biología, Universidad de Salamanca, Salamanca, Spain \^2 Estación Biológica de Doñana (EBD-CSIC).
Sevilla, Spain.

# Abstract

1.  The stability of ecological communities over time, often quantified using its aggregated abundance or biomass, is thought to be influenced by species richness and the asynchrony of species abundance fluctuations.
  However, the relationship between community stability and the stability of the ecosystem functioning provided by this community has been little explored, specially for functions involving several trophic levels such as plant pollination.
  Understanding the mechanisms driving community stability and whether this stability should be related to the stability of ecosystem functions provided is important for predicting the resilience of communities in front of the increasing threats to biodiversity.

2.  Using a 5-year dataset across 13 Mediterranean shrublands and 12 plant species, we assessed the effect of pollinator richness and asynchrony as drivers of stability in plant visitation rates and plant reproductive success.
  In addition, we analyzed whether the effects of species richness and visitation rate on plant reproduction success were consistent across the years.

3.  The stability of plant visitation rates is driven by the asynchrony of pollinator species abundances, but the effect of pollinator species richness is only indirect, as richer communities also tend to have more asynchronous populations.
  In contrast, the stability of plant reproductive success is not related to the stability of their pollinator visitation rates.
  A year-by-year analysis reveals that plants in the system studied are unlikely to be limited by pollinator abundance except in specific years, blurring any potential effect of visitation rate stability on reproductive success stability.

4.  We highlight the importance of maintaining a redundancy of pollinators that visit the same plant species, given that their presence can buffer the temporal fluctuations of pollinators.
  This is particularly important for pollinators with contrasting responses to environmental fluctuations, as this creates the needed asynchrony of their populations to guarantee stable levels of flower visitation rates.
   However, we warn that final ecosystem functions such as plant reproductive success, which not only depends on pollinators but on plant competition or resource availability, might be decoupled from first order ecosystem functions (i.e., visitation rates and pollen deposition) when pollination is not a limiting factor.
   
# Keywords
asynchrony, fruit set, pollinator richness, seed set, temporal stability.

# Introduction

Global environmental changes and the consequent loss of biodiversity have highlighted the need for a better understanding of the role of biodiversity in ecosystem function [@Hooper2005; @Lefcheck2015; @Oliver2015; @Hong2022]. We have experimental and observational evidence that biodiversity enhances aggregated community-level properties, such as total biomass [@Cardinale2006; @Cardinale2012; @Tilman2014], but the role of biodiversity in the stability of ecosystem functioning is less explored (but see @Griffin2009; @Grman2010), specially in functions involving several trophic levels such as plant pollination [@Ebeling2008; @Winfree2009a; @Garibaldi2011; @Lazaro2022].
Globally, it is estimated that at least 78% of wild plants depend to some extent on pollination by animals [@Ollerton2011].
Understanding the mechanisms driving pollinator community stability and how this relates to the stability of ecosystem functions and services delivered (i.e., pollination) is important for predicting changes in both community structure and ecosystem function.

Temporal stability is defined as the capacity of an ecosystem to dampen environmental perturbations over time while retaining ecological functions of interest [@Ives2007; @Pimm1984]. The temporal stability of the community can be influenced by the diversity of species present and the asynchrony of species abundance fluctuations. A higher number of species might stabilize community level functions by increasing the range of species level potential responses to environmental changes (i.e., the portfolio effect) [@McCann2000; @Tilman2006; @Hector2010; @Xu2021], although non-significant relationships between diversity and stability have also been observed [@Hooper2005; @VanderPlas2019]. Species asynchrony represents the intrinsic differences in species response to disturbances and/or environmental fluctuations [@Loreau2013] which has been suggested as a key driver for community temporal stability [@Loreau2008]. In this sense, higher levels of species asynchrony stabilize the overall community dynamics [@Ruijven2007; @Bluthgen2016; @Craven2018]. Species asynchrony is a factor driving positive relationships between diversity and stability [@Loreau2008; @Xu2015], and often stability is more strongly associated with the degree of asynchrony across species than with species richness itself [@Bluthgen2016; @Huang2020]. Other studies have indicated that the temporal stability of the dominant species, or the asynchrony among these dominant species, is important in maintaining the stability of ecosystems [@Sasaki2011; @Valencia2020].
While community temporal stability should be related to the stability of ecosystem functions and services provided by such a community, there is limited evidence linking both processes in multitrophic systems.

Since the reproductive success of most plant species highly depends on pollination by animals [@Ollerton2011], the stability of pollinator communities may increase the stability of plant reproductive success. Evidence from single-year studies suggests that different factors such as species richness and abundance may also be important for multi-year stability. For example, a greater diversity of pollinators has been shown to increase plant reproductive success as a result of complementarity in service provision arising from the variation of pollinator effectiveness across space and time of the day [@Hoehn2008; @Frund2010; @Albrecht2012; @Bluthgen2011; @Frund2013; @Magrach2021]. Pollinator species may exhibit different ranges of daily temporal activity [@Pisanty2016; @Rader2016; @Zaragoza-Trello2023] and consequently may provide pollination services at different times of the day or of the season. In addition, higher overall visitation rates are often assumed to ensure reproductive success. However, while some studies report that higher visitation rates are correlated with higher plant reproductive output [@Garibaldi2013; @Kaiser-Bunbury2017; @Vazquez2005], other studies find no such relationship [@Hegland2012; @Lundgren2013]. Interestingly, studies looking at pollen limitation show that higher visitation rates are often associated with no pollen limitation, indicating that above a certain threshold, changes in visitation rates are no longer relevant (Fig. 1) [@Cosacov2008; @Williams2013]. However, the occurrence and magnitude of pollen limitation can vary from year to year for individual populations [@Burd1994; @Ashman2004], mainly because of variations in pollinator service delivery [@Aizen2007]. All these  lines of evidence suggest that results found for single year studies should scale up to muti-year stability studies [@Garibaldi2011a; @Senapathi2021], but the evidence is mostly lacking for natural plant-pollinator systems.

![ Conceptual figure showing the expected general relationship between the visitation rate of pollinators and plant reproductive success to different species richness (R1, R2, ...). As the number of pollinator visits increases (V1, V2, …), plant reproductive success is expected to increase until that above a certain threshold, the changes in visitation rates are no longer relevant to plant reproductive success. Similarly, higer species richess is expected to increase reproductive success due to complmentary efffects among pollinators. According to this, the expected relationship between pollinator biodiversity and stability pollination depends on where we are along this curve. In point A, that temporal variation in plant reproductive success depends mainly on the variation in visitation, while in point B the reproductive success varies with the variation in richness.](Figures/conceptual_plot.png){width="400"}


Here, we use a 5-year dataset collected for a total of 12 plant species across 13 Mediterranean shrubland sites. However, to study the role of pollinator richness and asynchrony as drivers of the stability of visitation rates we use only the 5 most represented plant species across years and sites. We also assess whether more stable pollinator communities foster a more stable plant reproductive success across years, measuring both fruit and seed set stability.
We expect that the stability of visitation rates will increase with higher pollinator richness and asynchrony.
In addition, greater stability of plant reproductive success is expected with higher stability of visitation rates.
However, given the lack of a clear relationship between pollinator and plant reproductive output stability in our dataset, we further analyzed the variability in the yearly effect of pollinator richness and visitation rates on plant reproductive success.

# Material and methods

Our study was conducted in the southwest of the Iberian Peninsula (Huelva and Sevilla - Spain). We selected 13 sites in Mediterranean shrub ecosystems that ranged from sites with little to no disturbances to more modified ones with crops and urban areas nearby.
These sites are similar in the plant community composition and the most abundant plant species are known to be attractive to flower visitors and dependent on pollinators to maximize their reproduction (e.g., dominated by *Cistus crispus*, *Cistus ladanifer*, *Cistus salviifolius*, *Halimium halimifolium*, and *Lavandula pedunculata*).
Each site was surveyed at least 7 times per year during the flowering season from 2015 to 2019 (from March to June).
Within each site, we selected 3-4 individuals belonging to 3-9 plant species (mean ± standard error: 5.92 ± 0.54 plant species per site).
We conducted focal observations, recording all flower visitors (from now on referred to as pollinators) that made contact with their flowers.
Only pollinators that could not be identified in the field were captured, stored, and identified to species level in the laboratory.
For each plant individual, we counted the total number of flowers observed in each survey and we recorded the number of fruits developed/aborted and the number of seeds per fruit in a subsample of 3 fruits at the end of the season.
Focal observations had a duration of five minutes per individual from 2015-2016 and three minutes from 2017 to 2019.
Hence, for each plant individual, the sampling effort was standardized to the number of visits per flower per minute.
To that end, we calculated plant's visitation rate by dividing the total visits observed by the number of flowers observed and by the total observation time (time of each observation multiplied by the number of survey rounds per year).
Pollinator richness is calculated as the number of different pollinator species observed visiting the plant over all rounds, fruit set as the proportion of fruits developed (developed / aborted+developed), and the seed set as the mean number of seeds per fruit for each plant individual sampled per site.

## Stability

We analyse five plant species (*Cistus crispus*, *Cistus ladanifer*, *Cistus salviifolius*, *Halimium halimifolium*, and *Lavandula pedunculata*) that were recorded in at least 5 sites (mean = 7 ± 0.71 sites) in a minimum of two years per site (mean = 3.25 ± 0.16 years per plant).
The stability of pollinator visitation rates was quantified as the inverse of the coefficient of variation (mean/SD) for each plant species in each plot following Tilman (1999).
This is an adequate index given that in our dataset, as in most ecological studies, the variance scales with the mean.
To examine the role of richness and asynchrony of pollinator species abundances as drivers of stability of visitation rate, we calculate pollinator richness as the total number of different pollinator species that visit each plant species in each plot.
The synchrony index for each plant species in the plot was calculated following Loreau and de Mazancourt (2008), as: $$
\begingroup\Large
\phi =\frac{\sigma_{x_T}^2}{(\sum_{i=1}^S\sigma_{x_i})^2}
\endgroup
$$ where ${\sigma_{x_T}^2}$ is the variance of the community abundance of each plot and ${\sigma_{x_i}}$ is the standard deviation of species i abundance in a community with S species.
Note that we determined abundance as the total number of individuals that were observed, whereas the visitation rate is the total number of their visits.
This synchrony measurement varies from zero, when fluctuations are perfectly asynchronous, to one, when fluctuations are perfectly synchronous [@Loreau2008].
Finally, we express asynchrony as $1-\phi$.
We also calculated the stability of fruit proportion and the seed number for each plant species in each plot following the same methods.

## Statistical analysis

To evaluate the main drivers of visitation rate stability on the five plant species studied, we carried out two linear mixed models using as response variable the stability of visitation rate and as explanatory variables pollinator asynchrony and richness, respectively.
Similarly, linear mixed model was used to test the influence of pollinator richness on asynchrony of pollinator species abundances.
In all cases, site and plant species were included as random factors.
For a deeper understanding of the processes, we also analysed the response for each plant species separately.

To study whether the stability of pollinator visitation rate influences the stability of the plant reproductive success, we run linear mixed models using as response variables the stability of fruit proportion or the stability of seed number and as explanatory variable the visitation rate stability.
Site and plant species were included as random factors.

Finally, we further analysed the variability in the yearly effect of pollinator richness and visitation rate on plant reproductive success.
For this, we employed all plant species sampled and we analysed the interactive effect between richness and year, and between visitation rate and year on fruit proportion using a binomial generalized linear mixed model, and on the number of seeds employing a linear mixed model.
*P* values were obtained using the type III Anova (package: car [@Fox2011]) as recommended for testing interactions.
The number of seeds per fruit was centred and scaled per plant species to allow meaningful comparisons across species.
For all models, we included plant species identity nested within site and site as random effects because of multiple individuals of the same plant species are measured at each site.

All the analyses of this study were conducted in R software (v. 4.0.2; R Core Team, 2022) and the lme4 [@Bates2015] and ggplot2 [@Wickham2016] packages.
DHARMa package was employed for checking all models [@Hartig2017].

# Results

## Stability of visitation rate and its drivers: richness and asynchrony

Stability of visitation rates ranged from 0.64 to 9.24 (mean ± SE: 1.928 ± 0.232), whereas pollinator richness ranged from 2 to 20 species (8.128 ± 0.686) and the pollinator asynchrony varied from 0 to 0.998 (0.754 ± 0.032).
There was a strong positive relationship between the stability of visitation rates and asynchrony of pollinator species abundances with greater visitation rate stability when pollinator asynchrony increased (Estimate ± standard error: 2.903 ± 1.134; *p* = 0.017) (Fig 2A), whereas the stability of visitation rate was not influenced by the pollinator richness (-0.001 ± 0.063; *p* = 0.986) (Fig 2B).
However, we also found a positive relationship between asynchrony and pollinator richness (0.020 ± 0.005, *p* = 0.001) (Fig 2C).
We observed one data point has a high leverage on the stability analysis (*C.crispus*, Fig 2A-B), but when we remove this point, the slope is still positive (0.968 ± 0.745).

When we further analysed each plant species separately, we observed, as expected based on the previous analysis, a consisting positive relationship between the asynchrony of pollinators and stability of visitation rate for *C. crispus*, *H. halimifoliun* and *L. pedunculata*, a weak positive relationship for *C. salviifolious* and a weak negative relationship for *C. ladanifer*.
For the relationship with pollinator richness, *C. crispus*, *C. ladanifer* and *C. salviifolius* showed a negative relationship while *H. halimifolium* and *L. pedunculata* showed positive relationships, explaining the overall lack of relationship between he richness and stability of visitation rates across all five plants (Supplementary material-Fig 1).

```{r, echo=FALSE, warning=FALSE,message=FALSE,fig.height = 8,fig.width=20, out.width="100%",fig.align='center', fig.cap =" 2. Relationships between the stability of visitation rate (calculated as the inverse of the coefficient of variation) and asynchrony  of pollinators (Loreau and de Mazancourt’s index) (A), stability of visitation rate and pollinator richness (B), and asynchrony of pollinators and richness (C). Dots represent the different plant species included in the analysis. Significant models are represented with a solid line."}

library(tidyverse)
library(lme4)
library(effects)
library(patchwork)


# staility of visitation rate and richness and asynchrony
# plant species present at least in five sites
# C.crispu, C. ladanifer, C. salviifolius, H.halimifolium and L. pedunculata

# stability data 
data_plant<- read.csv("../Data/Stability.csv")
data_plant<-data_plant[,-1]


# eliminar plant species 
sp_out2=data_plant %>%
  group_by(Plant_gen_sp) %>%
  summarise(Unique_Id = n_distinct(Site_ID)) %>%
  filter(Unique_Id <= 4) %>%
  select(Plant_gen_sp) %>% pull(Plant_gen_sp)

#Data with species in at least 5 sites
data_plant = data_plant %>% filter(!Plant_gen_sp %in% sp_out2)


data_plant=data_plant %>%
  filter(!Plant_gen_sp=="Salvia rosmarinus") %>%
  filter(!Plant_gen_sp=="Halimium calycinum")%>%
  filter(!Plant_gen_sp=="Lavandula stoechas")



## Replace Inf and -Inf with NA
data_plant[is.na(data_plant) | data_plant == "Inf"] <- NA 
data_plant[is.na(data_plant) | data_plant == "-Inf"] <- NA 



# We can express asynchrony as 1 - φ, 
#where φ is Loreau and de Mazancourt’s (2008)
data_plant$asyn_LM= 1-data_plant$syncLM


#model 
mod1_sta= lmer (cv_1_visitation ~ asyn_LM + (1|Site_ID) + (1|Plant_gen_sp), data = data_plant)



#getting effects for asynchrony
effe_mod_sta <-data.frame( effect("asyn_LM", mod1_sta, se = TRUE))


#plot model of asynchrony
p1=ggplot(effe_mod_sta, aes(asyn_LM, fit)) + geom_line(size=1)+
  geom_ribbon(aes(ymin = lower, ymax = upper),alpha=0.2)+
  labs(color='Plant species')+
  coord_cartesian(ylim=c(-0.5,9.5))+
  geom_point(data = data_plant, aes(x =  asyn_LM, y = cv_1_visitation, color=Plant_gen_sp), alpha=0.7,size=6)+
  scale_colour_brewer(palette = "Set1")+
   theme_bw ()+
  labs(x = "Asynchrony of pollinator",y="Stability of visitation rate")+
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))



#model richness
mod1.2_sta= lmer (cv_1_visitation ~ S_total + (1|Site_ID) + (1|Plant_gen_sp), data = data_plant)


#getting effects for richness
effe2_mod_sta <-data.frame( effect("S_total", mod1.2_sta, se = TRUE))



#plot model of richness
p2=ggplot(effe2_mod_sta, aes(S_total, fit)) + geom_line(size=1,linetype = "dashed")+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha=0.1)+
  scale_y_continuous(limits = c(-0.5, 9.5))+  labs(color='Plant species')+
  geom_point(data = data_plant, aes(x =  S_total, y = cv_1_visitation, color=Plant_gen_sp), alpha=0.7,size=6)+
  scale_colour_brewer(palette = "Set1")+
  theme_bw ()+
  labs(x = "Richness of pollinator",y="Stability of visitation rate") +
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))
  

# relationship between richness and asynchrony
mod_rich_asyn= lmer (asyn_LM ~ S_total +  (1|Site_ID) + (1|Plant_gen_sp), weights = asyn_LM, data = data_plant)

#getting effects for richness
effe_rich_mod_sta <-data.frame( effect("S_total", mod_rich_asyn, se = TRUE))
#plot model 
p1.2=ggplot(effe_rich_mod_sta, aes(S_total, fit)) + geom_line(size=1)+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha=0.2)+
  labs(color='Plant species')+
  geom_point(data = data_plant, aes(x =  S_total, y = asyn_LM, color=Plant_gen_sp), alpha=0.7,size=6)+
  scale_colour_brewer(palette = "Set1")+
  theme_bw ()+
  labs(x = "Richness of pollinator",y="Asynchrony of pollinator")+
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))
  



#join plots
p_cv_visit=p1+p2+ p1.2+
  plot_annotation(tag_levels = "A")& 
  theme(plot.tag.position = c(0, 1),
        plot.tag = element_text(hjust = -0.1,vjust=0.5, size=25))& 
  theme(legend.position = "bottom",legend.background = element_blank(),legend.box.background = element_rect(colour = "black"))&theme(text = element_text(size=25))

p_cv_visit+ plot_layout(guides = "collect")


```

## Stability of visitation rate and stability of the plant reproductive success

The stability of fruit proportion varied from 2.62 to 120.66 (mean ± SE: 19.806 ± 3.615), whereas the stability of seed number ranged from 1.28 to 55.86 (7.018 ± 1.441).
When we analysed whether the pollinator visitation rate's stability affected plant reproductive success, we found no relationship when fruit proportion was considered (Estimate ± standard error: -1.547 ± 2.611; *p* = 0.558) (Fig 3A).
However, contrary to expectations, the stability of seed number showed a negative relationship with the stability of pollinator visitation rate (-1.887 ± 0.959; *p* = 0.061) (Fig 3B).
However, this relationship is influenced by a single high value in the stability of seed number of *H. halimifolium* (Fig 3B) and when this point is removed the relationship disappears and if anything, shows a positive slope (0.561 ± 0.535).

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 10,fig.width=20,out.width="80%",fig.align='center', fig.cap = " 3. Relationship between the stability of plant reproductive success: fruit proportion (A) and seed number (B) and the stability of visitation rate. Dots represent the different plant species included in the analysis. Significant models are represented with a solid line."}

#model fruit stability ~ visitation rate stability
mod2_sta= lmer(cv_1_fruit ~ cv_1_visitation + (1|Plant_gen_sp)+(1|Site_ID), data = data_plant)

#getting effects 
effe3_mod_sta <-data.frame( effect("cv_1_visitation", mod2_sta, se = TRUE))


#plot model 
p_mod2=ggplot(effe3_mod_sta, aes(cv_1_visitation, fit)) + geom_line(size=1,linetype = "dashed")+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha=0.1)+
  geom_point(data = data_plant, aes(x =  cv_1_visitation, y = cv_1_fruit, color=Plant_gen_sp),alpha=0.7, size=7)+
  labs(color='Plant species')+
  coord_cartesian(ylim=c(-10,120))+
  scale_colour_brewer(palette = "Set1")+
  labs(y = "Stability of fruit proportion",x="Stability of visitation rate")+
  theme_bw ()+
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))





# model seed stability ~ visitation rate stability
mod3_sta= lmer(cv_1_seed ~ cv_1_visitation + (1|Plant_gen_sp)+(1|Site_ID), data = data_plant)


#getting effects 
effe4_mod_sta <-data.frame( effect("cv_1_visitation", mod3_sta, se = TRUE))


#plot model 
p_mod3=ggplot(effe4_mod_sta, aes(cv_1_visitation, fit)) + geom_line(size=1)+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha=0.2)+
  labs(color='Plant species')+
  coord_cartesian(ylim=c(-5,60))+
  geom_point(data = data_plant, aes(x =  cv_1_visitation, y = cv_1_seed, color=Plant_gen_sp), alpha=0.7,size=7)+
  scale_colour_brewer(palette = "Set1")+
  labs(y = "Stability of seed number",x="Stability of visitation rate")+
  theme_bw ()+
  guides(colour=guide_legend(nrow=2,byrow=TRUE))+ theme(legend.text = element_text(face="italic"))



#join plots
p_plant=p_mod2+p_mod3+ 
  plot_annotation(tag_levels = "A")& 
  theme(plot.tag.position = c(0, 1),
        plot.tag = element_text(hjust = -0.8, vjust = 0.5,size=30))& 
  theme(legend.position = "bottom",legend.background = element_blank(),legend.box.background = element_rect(colour = "black"))&theme(text = element_text(size=30))
p_plant+ plot_layout(guides = "collect")

```

## Yearly variability on the effect of pollinators on reproductive success

To analyse whether the variability of pollinator richness and visitation rate across years affected the reproductive success of plants we used all plant species sampled.
When we analysed the variable fruit proportion, we found that the interactions between year and pollinator richness, and year and visitation rate affected the fruit proportion (richness x year: $\chi 2$ = 28.976, df = 4, *p* = \<0.0001; visitation rate x year: $\chi 2$ = 40.691, df = 4, *p* = \<0.0001).
Furthermore, we observed a significant effect of the year by itself, but not so of pollinator richness or visitation rate.
Note that we observed a general saturation of the proportion of fruits developed with most species consistently showing over 80% of fruit set, however, in years like 2017, for which the hydrological year was very dry, we found that a greater richness and visitation rate increased the fruit proportion.
We also observed a positive relationship between richness and fruit proportion in 2019.
However, in 2018, a specially wet year, the relationship between richness and fruit proportion was negative (Fig 4).

For the seed number analysis, we found an effect of year in both models in addition to the interaction between visitation rate and year ($\chi 2$ = 9.113, df = 4, *p* = 0.058) but not the interaction between pollinator richness and year ($\chi 2$ = 2.592, df = 4, *p* = 0.628).
We observed that a higher visitation rate increased the seed number in 2019 (Supplementary material-Fig 2).

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height =13,fig.width=30,out.width="100%", fig.align='center',fig.cap=" 4. Interaction effect between richness and year (top row), and visitation rate and year (bottom row) on fruit proportion. For visualization purposes, we omit from the visitation rate (x-axis) the values that are outside 95\\%."}


Pollinator_Plant<- read.csv("../Data/Pollinator_Plant.csv") #400 observaciones
Pollinator_Plant<-Pollinator_Plant[,-1]
Pollinator_Plant$Year= as.factor(Pollinator_Plant$Year)
Pollinator_Plant$Site_ID= as.factor(Pollinator_Plant$Site_ID)
Pollinator_Plant$Plant_gen_sp= as.factor(Pollinator_Plant$Plant_gen_sp)


# species out
#plant species that for each year occur only at one site
spp_out <- Pollinator_Plant %>%
  group_by(Plant_gen_sp, Year) %>%
  summarise(Unique_Id = n_distinct(Site_ID)) %>%
  filter(Unique_Id == 1) %>%
  select(Plant_gen_sp, Year)


Pollinator_Plant= anti_join(Pollinator_Plant, spp_out)



# model 1
mod1_to= glmer(cbind(fruit_formado, Fruit_No) ~ S_total * Year + (1|Site_ID/Plant_gen_sp),family=binomial,data=Pollinator_Plant)

#getting effects for the two variables
ee_mod1 <- as.data.frame(Effect(c("S_total","Year"),mod = mod1_to))

p1=ggplot(ee_mod1, aes(S_total,fit))+
  geom_line(size=0.8)+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)+
  geom_point(data= Pollinator_Plant, aes(x = S_total , y = fruit_proportion),shape=21, fill="grey", size=6)+
  labs(x = "Pollinator richness",y="Fruit proportion")+
  facet_wrap(~Year, nrow = 1) + 
  theme_bw ()+
  theme(legend.position = "none")



# model 2
mod2_to= glmer(cbind(fruit_formado, Fruit_No) ~ visitatio_rate * Year + (1|Site_ID/Plant_gen_sp),family=binomial,data=Pollinator_Plant)

#getting effects for the two variables
ee_mod2 <- as.data.frame(Effect(c("visitatio_rate","Year"),mod = mod2_to))

p2=ggplot(ee_mod2, aes(visitatio_rate,fit))+
  geom_line(size=0.8)+  
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)+
  geom_point(data= Pollinator_Plant, aes(x =visitatio_rate , y = fruit_proportion),shape=21, fill="grey", size=6)+
  labs(x = "Visitation rate",y="Fruit proportion")+
  facet_wrap(~Year, nrow = 1) + 
  coord_cartesian(xlim=c(0, quantile(Pollinator_Plant$visitatio_rate,0.95)))+
  theme_bw ()+
  theme(legend.position = "none")


p1/p2&theme(text = element_text(size=35))


```

# Discussion

In this study, we show that the stability of pollinator visitation rate increases with higher asynchrony of pollinator species abundances and that greater species richness increases the stability of visitation rate only indirectly, via enhanced species asynchrony. However, contrary to what could be expected we found no relationship between the stability of visitation rates and the stability of plant reproductive success.
This is because, in our study system, plant reproduction is not pollinator limited in most years, with most plants reaching maximum reproductive success even in the sites with lower pollinator abundances.
However, this does not imply that pollinators are not important or that are always in enough numbers to disregard them, because for specific years the relationship between pollinator activity and plant's reproductive output kicks in as important.
When and where pollinators are limiting is the key question then.

While drivers of temporal stability have been well-studied in plant communities [@Ruijven2007; @Gross2014; @Craven2018; @Leps2018; @Sasaki2019; @Valencia2020; @Kigel2021], relatively few studies have evaluated how these same drivers can affect community stability in mobile organisms such as pollinators [@Ebeling2008; @Senapathi2021; @Lazaro2022]. The first outcome of our analysis is that the asynchrony of species abundances is a key driver of visitation rate stability. This stability-asynchrony relationship has been found by different theoretical and empirical studies [@DeMazancourt2013; @Bluthgen2016; @Leps2018; @Sasaki2019; @Valencia2020; @Kigel2021]. For example, Lázaro et al.(2022) also found for plants, pollinators and their interactions that more asynchronous communities are more temporally stable. In this sense, species asynchrony can increase the temporal stability of visitation rate when the abundance of one species increases as a result of decreases in the abundance of another species (i.e., density compensation [@Winfree2009a; @Mukherjee2019]); or also when they respond differently to the same environmental changes (i.e., response diversity [@Walker99; @Winfree2013]).
While we do not evaluate the causes of this response diversity, we do show that the asynchronous fluctuating species are redundant in their visitation patterns, a known requisite for response diversity to matter for ecosystem functioning stability [@Stavert2017].

On the other hand, species richness is considered one of the strongest drivers of community stability in plants [@Tilman2006; @Hallett2014], although Valencia et al. (2020), analysing a large number of plant community datasets, have reported that this relationship is not as strong as initially shown. Pollinator studies carried out in crop systems have observed a positive relationship between species richness and stability of floral visits [@Ebeling2008] or the stability of pollinator abundance [@Senapathi2021]. However, our results show that pollinator richness effects were mostly indirect. Pollinator richness was positively associated with asynchrony, which positively affects the stability of the visitation rate, but is not associated directly with more stable visitation rates. Species richness is suggested to increase the probability that a community contains species with different responses to environmental conditions and perturbations, leading to asynchrony (compensation) among species abundance and thus, to an increase in community stability [@Craven2018; @McCann2000; @Yachi1999], but the asynchrony of a few dominant species might be more relevant in pollinator systems than richness per se [@Winfree2015; @Kleijn2015].

Despite temporal stability is crucial to the sustainability of ecosystem functions, relatively few studies have evaluated the stability of the pollinator abundances on pollination services, and those who did use agricultural systems [@Garibaldi2011; @Garibaldi2013; @Lazaro2019; @Hunicken2021]. To the best of our knowledge, how the stability of the pollinator community affects the reproductive success of wild plant communities remains largely unknown. In pollinator-dependent crops, it has been observed that greater yield stability is related to pollinator diversity and the stability of visitation rates [@Garibaldi2011; @Garibaldi2013; @Hunicken2021] but in our study system (wild plants), we did not find this relationship. Despite we observed that in specific years a higher visitation rate or richness of pollinators increases the proportion of fruits, for most plants and years there is a general saturation of the proportion of fruits developed, with fruit sets above 80%. As shown in Figure 1, an initial increase in the number of pollinator visits is predicted to increase the reproductive success of the plant but as visitation rates continue to increase, its effect will level off or even decline [@Young1992; @Morris2010]. Bees can remove 70--80% of the pollen that is presented in a flower and a flower's pollen can be exhausted after only a few visits [@harder90; @Kudo2005]. Therefore, its reproductive success may not continue to increase with increased visitation, but instead may saturate quickly because of pollen depletion [@Thomson2001]. As pollen limitation can be more common in crop systems with large pulses of monospecific floral resources, this might explain the discrepancies among our findings and crop studies. However, several factors can mediate the degree of pollen limitation in natural communities. Most importantly, variations in abiotic factors can affect both pollinator abundance and host plants [@Vicens2000; @Ivey2003] affecting the ratio of flowers per pollinator. The availability of floral resources determines the pollinator demand, and floral quantity, diversity and composition at local scales can concentrate or dilute pollinator activity [@VanNuland2013; @Veddeler2006] as well as influence plant constancy [@Kunin1996], and pollen deposition [@Evans2017].
For instance, the variation of temperature conditions leads to alterations in nectar production, composition, and concentration [@Pacini2003], which can affect to the pollinator behaviour.
Although investigating these factors is beyond the aim of the study, future research should clarify when and where pollinators are limiting.
For example, Herbertsson et al. (2021) showed in a recent meta-analysis a large variability in the effects of different pollinators on seed sets, and Ryan et al. (2023) found interannual variation in fruit yields in raspberries crops, but the causes of this variability remain to be explored.

In summary, our study highlights the importance of pollinator species' asynchrony in maintaining the temporal stability of their visitation rates to wild plants in natural environments.
However, visitation rate stability did not directly contribute to the stability of the final plant reproductive success function.
In this sense, we believe that further studies are needed to better understand these mechanisms in natural communities by assessing the reproductive success of a wider variety of plant species over time [@Thomson2019].
The variations seen between years suggest that in our study system, plant reproduction is not typically limited by pollinators, but other systems might be much more pollinator limited.
However, it is important that the relationship between pollinator activity and plant reproductive success is important in certain years.
This study contributes to understanding the mechanisms driving the temporal stability of pollinator communities in natural systems and how the relationships between pollinators and plant reproductive success may vary from year to year.

\newpage

# Acknowledgements

This study was supported by the BeeFun project (PCIG14-GA-2013-631653). Estefania Tobajas thanks the Bartomeus lab and Estacion Biologica de Doñana (EBD-CSIC) for hosting during the research stay.
Estefanía Tobajas was funded by a "Postdoc contract" (Ayudas Margarita Salas. Ministerio de Universidades-Universidad de Salamanca).

# Author contributions

All authors designed the idea.
Francisco P. Molina and Ignasi Bartomeus collected the data.
Estefanía Tobajas conducted the analyses with the contributions of Virginia Domínguez-García and the guidance of Ignasi Bartomeus.
Estefanía Tobajas wrote the manuscript with the contributions of all authors.

# Conflict of interest

The authors declare no conflict of interest.

# Supplementary material

```{r, echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=30,out.width="100%", fig.align='center',fig.cap=" 1. Changes in the stability of visitation rate with the asynchrony (top row) and richness (bottom row) are shown for each plant species."}
# model plot (cv_1_visitation~S_total+asynchrony)


# plot for richness
plot_stabi_plant <- data_plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(cv_1_visitation~S_total,data))) %>%
  mutate(mod1 = list(ggeffects::ggpredict(mod, terms = "S_total"))) %>%
  mutate(plots = list(ggplot(mod1, aes(x, predicted)) + geom_line(size=1) +
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high), linetype = 3, alpha=0.2, colour = "black")))

#Cistus crispus
p1=plot_stabi_plant$plots[[1]] + geom_point(data =data_plant %>% filter(Plant_gen_sp == "Cistus crispus"), 
  aes(x =  S_total, y = cv_1_visitation),color="#e41a1c", alpha=0.7,size=7)+ 
  labs(x = "",y="Stability of visitation rate")+scale_x_continuous(limits = c(9, 16))+
  scale_y_continuous(limits = c(-5,9.5))+
  theme_bw ()


#Cistus ladanifer
p2=plot_stabi_plant$plots[[2]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus ladanifer"), 
  aes(x =  S_total, y = cv_1_visitation),color="#377eb8",alpha=0.7, size=7)+ 
  labs(x = "",y=NULL)+scale_x_continuous(limits = c(3, 16))+ 
  scale_y_continuous(limits = c(-1.55,4))+
  theme_bw()

#Cistus salviifolius
p3=plot_stabi_plant$plots[[3]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus salviifolius"), 
  aes(x =  S_total, y = cv_1_visitation),color= "#4daf4a",alpha=0.7, size=7)+ 
  labs(x = "Richness",y=NULL)+scale_x_continuous(limits = c(3, 20))+  
  scale_y_continuous(limits = c(-3,6))+
  theme_bw()


#Halimium halimifolium
p4=plot_stabi_plant$plots[[4]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Halimium halimifolium"), 
  aes(x =  S_total, y = cv_1_visitation), color= "#984ea3",alpha=0.7, size=7)+   labs(x = "",y=NULL)+ scale_x_continuous(limits = c(4, 14))+ 
  scale_y_continuous(limits = c(-0.7,3))+
  theme_bw()


#Lavandula pedunculata
p5=plot_stabi_plant$plots[[5]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Lavandula pedunculata"), 
  aes(x =  S_total, y = cv_1_visitation),color="#ff7f00",alpha=0.7, size=7)+ 
  labs(x = "",y=NULL)+  
  scale_y_continuous(limits = c(-0.7,4.7))+
  theme_bw()




# model plot for asynchrony
plot_stabi_plant_2 <- data_plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(cv_1_visitation~asyn_LM,data))) %>%
  mutate(mod1 = list(ggeffects::ggpredict(mod, terms = "asyn_LM"))) %>%
  mutate(plots = list(ggplot(mod1, aes(x, predicted)) + geom_line(size=1) +
 geom_ribbon(aes(ymin = conf.low, ymax = conf.high),linetype = 3, alpha=0.2, colour = "black")))


#Cistus crispus
p1.1=plot_stabi_plant_2$plots[[1]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus crispus"), 
  aes(x =  asyn_LM, y = cv_1_visitation),color="#e41a1c",alpha=0.7, size=7)+ 
  labs(x = "",y="Stability of visitaion rate",subtitle = "Cistus crispus")+
  scale_y_continuous(limits = c(-5,9.5))+
   theme_bw()+theme( plot.subtitle = element_text(face = "italic"))


#Cistus ladanifer
p2.1=plot_stabi_plant_2$plots[[2]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus ladanifer"), 
  aes(x =  asyn_LM, y = cv_1_visitation),color="#377eb8", alpha=0.7,size=7)+ 
  labs(x = "",y=NULL,subtitle = "Cistus ladanifer")+ 
  scale_y_continuous(limits = c(-1.55,4))+
  theme_bw()+theme( plot.subtitle = element_text(face = "italic"))


#Cistus salviifolius
p3.1=plot_stabi_plant_2$plots[[3]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Cistus salviifolius"), 
  aes(x =  asyn_LM, y = cv_1_visitation),color= "#4daf4a",alpha=0.7, size=7)+ 
  labs(x = "Asynchrony of pollinators",y= NULL,subtitle = "Cistus salviifolius")+ 
  scale_y_continuous(limits = c(-3,6))+
  theme_bw()+theme( plot.subtitle = element_text(face = "italic"))


#Halimium halimifolium
p4.1=plot_stabi_plant_2$plots[[4]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Halimium halimifolium"), 
  aes(x =  asyn_LM, y = cv_1_visitation), color= "#984ea3", alpha=0.7,size=7)+   labs(x = "",y=NULL,subtitle = "Halimium halimifolium")+ 
  scale_y_continuous(limits = c(-0.7,3))+
  theme_bw() +theme( plot.subtitle = element_text(face = "italic"))


#Lavandula pedunculata
p5.1=plot_stabi_plant_2$plots[[5]] + geom_point(data = data_plant %>% filter(Plant_gen_sp == "Lavandula pedunculata"), 
  aes(x =  asyn_LM, y = cv_1_visitation), color="#ff7f00",alpha=0.7, size=7)+ 
  labs(x = "",y=NULL,subtitle = "Lavandula pedunculata")+  
  scale_y_continuous(limits = c(-0.7,4.7))+
  theme_bw() +theme( plot.subtitle = element_text(face = "italic"))



#join plot
p1.1+p2.1+p3.1+p4.1+p5.1+p1+p2+p3+p4+p5+plot_layout(ncol = 5)& theme(axis.title = element_text(face="bold"))&theme(text = element_text(size=30))


```

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=30,out.width="100%", fig.align='center',fig.cap=" 2. Interaction effect between richness and year (top row), and visitation rate and year (bottom row) on seed number. For visualization purposes, we omit from the visitation rate (x-axis) the values that are outside 95\\%."}

# #scale seed number variable
Pollinator_Plant=Pollinator_Plant %>% 
  group_by(Plant_gen_sp) %>%
  mutate(seed_sc=scale(Seeds, center = T, scale = T))

#model3
mod3_to= lmer(seed_sc ~S_total * Year + (1|Site_ID/Plant_gen_sp),data=Pollinator_Plant)

#getting effects for the two variables
ee_mod3 <- as.data.frame(Effect(c("S_total","Year"),mod = mod3_to))

p3=ggplot(ee_mod3, aes(S_total,fit))+
  geom_line(size=0.8)+ 
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)+
  geom_point(data= Pollinator_Plant, aes(x = S_total , y = seed_sc),shape=21, fill="grey", size=6)+
  labs(x = "Pollinator richness",y="Seed number")+
  ylim(-3,3)+
  facet_wrap(~Year, nrow = 1) + 
  theme_bw ()+
  theme(legend.position = "none")

#model4
mod4_to= lmer(seed_sc ~ visitatio_rate*Year + (1|Site_ID/Plant_gen_sp),data=Pollinator_Plant)


#getting effects for the two variables
ee_mod4 <- as.data.frame(Effect(c("visitatio_rate","Year"),mod = mod4_to))

#plot

p4 = ggplot(ee_mod4, aes(visitatio_rate,fit))+
  geom_line(size=0.8)+
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = .2)+
  geom_point(data= Pollinator_Plant, aes(x =visitatio_rate , y = seed_sc),shape=21, fill="grey",size=6)+
  labs(x = "Visitation rate",y="Seed number")+
  facet_wrap(~Year, nrow = 1) + 
  coord_cartesian(xlim=c(0, quantile(Pollinator_Plant$visitatio_rate,0.95)),ylim = c(-3,3))+
  theme_bw ()+
  theme(legend.position="none")

p3/p4 &theme(text = element_text(size=35))

```

# References
