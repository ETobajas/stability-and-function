---
title: "Models with year"
output: pdf_document
date: '2022-10-05'
---


# Seed number

**Visitation rate (all pollinators)**

we analyse whether the visitation rate of all pollinators, years and their interaction affect to the seed number for each plant species

**A-** linear model: lm(Seeds~visitatio_rate * Year)

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

library(tidyverse)
library(broom.mixed)
library(broom)
library(lmerTest)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggeffects)
library(patchwork)
library(ggcorrplot)
library(ggpubr)
library(kableExtra)
library(sjPlot)

Pollinator_Plant<- read.csv("../Data/Pollinator_Plant_Apis_separada.csv") 
Pollinator_Plant<-Pollinator_Plant[,-1]

#Species out
spp_out <- Pollinator_Plant %>%
  group_by(Plant_gen_sp) %>%
  summarise(Unique_Id = n_distinct(Site_ID)) %>%
  filter(Unique_Id == 1) %>%
  select(Plant_gen_sp) %>% pull(Plant_gen_sp)


#Data with species in more than 1 site
Pollinator_Plant = Pollinator_Plant %>% filter(!Plant_gen_sp %in% spp_out)

# replace NAs by 0
# hay especies de plantas que presentan datos de fruit y seed pero no de polinizador (durante el tiempo observado no se ve ningun polinizador )
Pollinator_Plant <- mutate_all(Pollinator_Plant, ~replace(., is.na(.), 0))

Pollinator_Plant$Year <- factor(Pollinator_Plant$Year)

#model
mod_seed_year<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds~visitatio_rate * Year,data))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_seed_year<-mod_seed_year %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_seed_year %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_seed_year$p.value < 0.05| is.na(mod_seed_year$p.value), T, F) )%>%
  kable_styling(position="left")

```


```{r, echo=FALSE, warning=FALSE,message=FALSE, out.width="80%", fig.align='left'}

mod_seed_year_glance<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds~visitatio_rate * Year,data))) %>%
  summarize(glance(mod))%>%
  ungroup()

table1<-mod_seed_year_glance %>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Asphodelus fistulosus','A.fistulosus', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Cistus crispus', 'C.crispus', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Cistus ladanifer', 'C.ladanifer', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Cistus libanotis', 'C.libanotis', Plant_gen_sp))%>%
   mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Cistus monspeliensis', 'C.monspeliensis', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Cistus salviifolius', 'C.salviifolius', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Halimium calycinum', 'H. calycinum', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Halimium halimifolium', 'H.halimifolium', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Lavandula pedunculata', 'L.pedunculata', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Lavandula stoechas', 'L.stoechas', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Salvia rosmarinus', 'S.rosmarinus', Plant_gen_sp))%>%
  mutate( Plant_gen_sp = if_else(Plant_gen_sp == 'Teucrium fruticans', 'T.fructicans', Plant_gen_sp))

table1 %>% 
    kable("latex",booktabs = TRUE, digits =  3,linesep = "",align = "lcccccccccccc") %>%
  kable_styling(font_size = 7,full_width = F, position="left")

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}
mod_seed_year.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds~visitatio_rate * Year,data)))

# estimates of model 
ggarrange(plot_model(mod_seed_year.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3), ncol=3,nrow = 4)

```


\newpage
Predicte values of seed number

*Cistus monspeliensis* - *Halimium halimifolium* - *Teucrium fructicans* 
Warning message:
In predict.lm(model, newdata = fitfram, type = "response", se.fit = se,: prediction from a rank-deficient fit may be misleading

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_seed_year.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_seed_year.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_seed_year.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_seed_year.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_seed_year.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_seed_year.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_seed_year.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_seed_year.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_seed_year.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_seed_year.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_seed_year.1$mod[[5]], type = "int", title = "Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_seed_year.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$visitatio_rate,p1$Year,p1.1,
p2$visitatio_rate,p2$Year,p2.1,
p3$visitatio_rate,p3$Year,p3.1,
p4$visitatio_rate,p4$Year,p4.1,
p5$visitatio_rate,p5$Year,p5.1,
p6$visitatio_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_seed_year.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_seed_year.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_seed_year.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_seed_year.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_seed_year.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_seed_year.1$mod[[12]], type = "pred",title = " Teucrium fruticans")

p7.1=plot_model(mod_seed_year.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_seed_year.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_seed_year.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_seed_year.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_seed_year.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_seed_year.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)

ggarrange(p7$visitatio_rate,p7$Year,p7.1,
p8$visitatio_rate,p8$Year,p8.1,
p9$visitatio_rate,p9$Year,p9.1,
p10$visitatio_rate,p10$Year,p10.1,
p11$visitatio_rate,p11$Year,p11.1,
p12$visitatio_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```

**Importante**: Cistus crispus en 2015 solo tiene dos valores, uno con 0 semillas y visitation rate 0.214; y otro con casi 40 semillas y visitation rate 0

\newpage

Predicted values of Seeds for *Cistus crispus*

```{r,echo=FALSE, warning=FALSE,message=FALSE}
get_model_data(mod_seed_year.1$mod[[2]], type = "int")

```

\newpage

**B-** linear mixed model with site ID like random factor
```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

#model
mod_mix_seed_year<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(model = list(lmer(Seeds ~ visitatio_rate * Year + (1 | Site_ID),data))) %>%
  summarise(broom.mixed::tidy(model)) %>%
  ungroup()

mod_mix_seed_year<-mod_mix_seed_year %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_seed_year<-filter(mod_mix_seed_year, !term == "sd__(Intercept)" & !term =="sd__Observation")


mod_mix_seed_year %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(7, bold = ifelse(mod_mix_seed_year$p.value < 0.05, T, F) )%>%
  kable_styling(position="left")

```

elimana algunos valores de interacciones en *C.monspeliensis*, *H.halimifolium* y *T.fructicans*: fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients - 1 column / coefficient - 1 column / coefficient

Además boundary (singular) fit: see help('isSingular')

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}

#model plot
mod_mix_seed_year.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lmer(Seeds ~ visitatio_rate * Year + (1 | Site_ID),data)))


# estimates of model 
ggarrange(plot_model(mod_mix_seed_year.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3), ncol=3,nrow = 4)

```

\newpage
Predicted values of Seeds

*Cistus monspeliensis* - *Halimium halimifolium* - *Teucrium fructicans* 
Could not compute variance-covariance matrix of predictions. No confidence intervals are returned.

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_mix_seed_year.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_mix_seed_year.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_seed_year.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_seed_year.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_seed_year.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_mix_seed_year.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_mix_seed_year.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_mix_seed_year.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_mix_seed_year.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_mix_seed_year.1$mod[[4]], type = "int",title = "Cistus libanotis", show.data = TRUE)
p5.1=plot_model(mod_mix_seed_year.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_mix_seed_year.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$visitatio_rate,p1$Year,p1.1,
p2$visitatio_rate,p2$Year,p2.1,
p3$visitatio_rate,p3$Year,p3.1,
p4$visitatio_rate,p4$Year,p4.1,
p5$visitatio_rate,p5$Year,p5.1,
p6$visitatio_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_seed_year.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_seed_year.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_seed_year.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_seed_year.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_seed_year.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_seed_year.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_mix_seed_year.1$mod[[7]], type = "int",title = " Halimium calycinum", show.data = TRUE)
p8.1=plot_model(mod_mix_seed_year.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_mix_seed_year.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_mix_seed_year.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_mix_seed_year.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_mix_seed_year.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)


ggarrange(p7$visitatio_rate,p7$Year,p7.1,
p8$visitatio_rate,p8$Year,p8.1,
p9$visitatio_rate,p9$Year,p9.1,
p10$visitatio_rate,p10$Year,p10.1,
p11$visitatio_rate,p11$Year,p11.1,
p12$visitatio_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```


**se prueban modelos con year like random slope** 

Hay especies que dan problema porque hay menos observaciones que 
random effect. El error dice:  the random-effects parameters and the residual variance (or scale parameter) are probably unidentifiable. Las especies que dan problema y habria que eliminar son: Halimium calycinum, Lavandula pedunculata, Lavandula stoechas, Salvia rosmarinus


\newpage
**Visitation rate of *Apis mellifera* **

**A-** linear model: lm(Seeds ~ Apis_visitatio_rate * Year)
```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}
#model
mod_seed_year_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ Apis_visit_rate * Year,data))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_seed_year_apis<-mod_seed_year_apis %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_seed_year_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_seed_year_apis$p.value < 0.05| is.na(mod_seed_year_apis$p.value), T, F) )%>%
  kable_styling(position="left")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}
mod_seed_year_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ Apis_visit_rate * Year,data)))

ggarrange(plot_model(mod_seed_year_apis.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_apis.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3), ncol=3,nrow = 4)

```


\newpage

Predicted values of Seeds 

*Asphodelus fistulosus* - *Cistus libanotis*- *Cistus monspeliensis* - *Halimium calycinum* - *Halimium halimifolium* - *Teucrium fructicans* 

Warning message: In predict.lm(model, newdata = fitfram, type = "response", se.fit = se,: prediction from a rank-deficient fit may be misleading

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_seed_year_apis.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_seed_year_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_seed_year_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_seed_year_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_seed_year_apis.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_seed_year_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_seed_year_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_seed_year_apis.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_seed_year_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_seed_year_apis.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_seed_year_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_seed_year_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$Apis_visit_rate,p1$Year,p1.1,
p2$Apis_visit_rate,p2$Year,p2.1,
p3$Apis_visit_rate,p3$Year,p3.1,
p4$Apis_visit_rate,p4$Year,p4.1,
p5$Apis_visit_rate,p5$Year,p5.1,
p6$Apis_visit_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_seed_year_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_seed_year_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_seed_year_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_seed_year_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_seed_year_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_seed_year_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")



p7.1=plot_model(mod_seed_year_apis.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_seed_year_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_seed_year_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_seed_year_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_seed_year_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_seed_year_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)



ggarrange(p7$Apis_visit_rate,p7$Year,p7.1,
p8$Apis_visit_rate,p8$Year,p8.1,
p9$Apis_visit_rate,p9$Year,p9.1,
p10$Apis_visit_rate,p10$Year,p10.1,
p11$Apis_visit_rate,p11$Year,p11.1,
p12$Apis_visit_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```



\newpage
**B-** linear mixed model with site ID like random factor

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

#model
mod_mix_seed_year_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(model = list(lmer(Seeds ~ Apis_visit_rate * Year + (1 | Site_ID),data))) %>%
  summarise(broom.mixed::tidy(model)) %>%
  ungroup()

mod_mix_seed_year_apis<-mod_mix_seed_year_apis %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_seed_year_apis<-filter(mod_mix_seed_year_apis, !term == "sd__(Intercept)" & !term =="sd__Observation")


mod_mix_seed_year_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(7, bold = ifelse(mod_mix_seed_year_apis$p.value < 0.05, T, F) )%>%
  kable_styling(position="left")

```

elimana algunos valores de interacciones en *Asphodelus fistulosus* - *Cistus libanotis*- *Cistus monspeliensis* - *Halimium calycinum* - *Halimium halimifolium* - *Teucrium fructicans*: fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients - 1 column / coefficient - 1 column / coefficient

Además boundary (singular) fit: see help('isSingular')


\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}
#model plot
mod_mix_seed_year_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lmer(Seeds ~ Apis_visit_rate * Year + (1 | Site_ID),data)))

ggarrange(plot_model(mod_mix_seed_year_apis.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_apis.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)
```


\newpage

Predicted values of Seeds 

*Asphodelus fistulosus* - *Cistus libanotis*- *Cistus monspeliensis* - *Halimium calycinum* - *Halimium halimifolium* - *Teucrium fructicans* 
Could not compute variance-covariance matrix of predictions. No confidence intervals are returned

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_mix_seed_year_apis.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_mix_seed_year_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_seed_year_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_seed_year_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_seed_year_apis.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_mix_seed_year_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_mix_seed_year_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_mix_seed_year_apis.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_mix_seed_year_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_mix_seed_year_apis.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_mix_seed_year_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_mix_seed_year_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$Apis_visit_rate,p1$Year,p1.1,
p2$Apis_visit_rate,p2$Year,p2.1,
p3$Apis_visit_rate,p3$Year,p3.1,
p4$Apis_visit_rate,p4$Year,p4.1,
p5$Apis_visit_rate,p5$Year,p5.1,
p6$Apis_visit_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_seed_year_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_seed_year_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_seed_year_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_seed_year_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_seed_year_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_seed_year_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")



p7.1=plot_model(mod_mix_seed_year_apis.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_mix_seed_year_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_mix_seed_year_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_mix_seed_year_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_mix_seed_year_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_mix_seed_year_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)



ggarrange(p7$Apis_visit_rate,p7$Year,p7.1,
p8$Apis_visit_rate,p8$Year,p8.1,
p9$Apis_visit_rate,p9$Year,p9.1,
p10$Apis_visit_rate,p10$Year,p10.1,
p11$Apis_visit_rate,p11$Year,p11.1,
p12$Apis_visit_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```



\newpage
**Visitation rate of pollinator without *Apis mellifera* **

**A-** linear model: lm(Seeds ~ No_Apis_visitatio_rate * Year)
```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}
#model
mod_seed_year_no_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ No_Apis_visit_rate * Year,data))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_seed_year_no_apis<-mod_seed_year_no_apis %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_seed_year_no_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_seed_year_no_apis$p.value < 0.05| is.na(mod_seed_year_no_apis$p.value), T, F) )%>%
  kable_styling(position="left")

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}


#model plot
mod_seed_year_no_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ No_Apis_visit_rate * Year,data)))

ggarrange(plot_model(mod_seed_year_no_apis.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_no_apis.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)

```

\newpage

Predicted values of Seeds 

*Cistus monspeliensis* - *Halimium halimifolium* - *Teucrium fructicans* 
Warning message:
In predict.lm(model, newdata = fitfram, type = "response", se.fit = se,: prediction from a rank-deficient fit may be misleading

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_seed_year_no_apis.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_seed_year_no_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_seed_year_no_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_seed_year_no_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_seed_year_no_apis.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_seed_year_no_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")

p1.1=plot_model(mod_seed_year_no_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_seed_year_no_apis.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_seed_year_no_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_seed_year_no_apis.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_seed_year_no_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_seed_year_no_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$No_Apis_visit_rate,p1$Year,p1.1,
p2$No_Apis_visit_rate,p2$Year,p2.1,
p3$No_Apis_visit_rate,p3$Year,p3.1,
p4$No_Apis_visit_rate,p4$Year,p4.1,
p5$No_Apis_visit_rate,p5$Year,p5.1,
p6$No_Apis_visit_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```


\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_seed_year_no_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_seed_year_no_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_seed_year_no_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_seed_year_no_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_seed_year_no_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_seed_year_no_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_seed_year_no_apis.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_seed_year_no_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_seed_year_no_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_seed_year_no_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_seed_year_no_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_seed_year_no_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)


ggarrange(p7$No_Apis_visit_rate,p7$Year,p7.1,
p8$No_Apis_visit_rate,p8$Year,p8.1,
p9$No_Apis_visit_rate,p9$Year,p9.1,
p10$No_Apis_visit_rate,p10$Year,p10.1,
p11$No_Apis_visit_rate,p11$Year,p11.1,
p12$No_Apis_visit_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```


\newpage 

**B-** linear mixed model with site ID like random factor

Warning messages:Some predictor variables are on very different scales: consider rescaling. The warning occurred in Salvia rosmarinus
No_Apis_visit_rate:Year2016 -> 364.706 (Estimate); 813.126 (std.error)

elimana algunos valores de interacciones en *C.monspeliensis*, *H.halimifolium* y *T.fructicans*: fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients - 1 column / coefficient - 1 column / coefficient

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

#model
mod_mix_seed_year_no_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(model = list(lmer(Seeds ~ No_Apis_visit_rate * Year + (1 | Site_ID),data))) %>%
  summarise(broom.mixed::tidy(model)) %>%
  ungroup()


mod_mix_seed_year_no_apis<-mod_mix_seed_year_no_apis %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_seed_year_no_apis<-filter(mod_mix_seed_year_no_apis, !term == "sd__(Intercept)" & !term =="sd__Observation")


mod_mix_seed_year_no_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(7, bold = ifelse(mod_mix_seed_year_no_apis$p.value < 0.05, T, F) )%>%  kable_styling(position="left")

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}


#model plot
mod_mix_seed_year_no_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lmer(Seeds ~ No_Apis_visit_rate * Year + (1 | Site_ID),data)))


ggarrange(plot_model(mod_mix_seed_year_no_apis.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[2]], title = "Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_no_apis.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)

```

\newpage
Predicted values of Seeds 

*C.monspeliensis*, *H.halimifolium* y *T.fructicans*
Could not compute variance-covariance matrix of predictions. No confidence intervals are returned
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_mix_seed_year_no_apis.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_mix_seed_year_no_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_seed_year_no_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_seed_year_no_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_seed_year_no_apis.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_mix_seed_year_no_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")

p1.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = T)
p2.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = T)
p3.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = T)
p4.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = T)
p5.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = T)
p6.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = T)

ggarrange(p1$No_Apis_visit_rate,p1$Year,p1.1,
p2$No_Apis_visit_rate,p2$Year,p2.1,
p3$No_Apis_visit_rate,p3$Year,p3.1,
p4$No_Apis_visit_rate,p4$Year,p4.1,
p5$No_Apis_visit_rate,p5$Year,p5.1,
p6$No_Apis_visit_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_seed_year_no_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_seed_year_no_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_seed_year_no_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_seed_year_no_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_seed_year_no_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_seed_year_no_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = T)
p8.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = T)
p9.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = T)
p10.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = T)
p11.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = T)
p12.1=plot_model(mod_mix_seed_year_no_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = T)


ggarrange(p7$No_Apis_visit_rate,p7$Year,p7.1,
p8$No_Apis_visit_rate,p8$Year,p8.1,
p9$No_Apis_visit_rate,p9$Year,p9.1,
p10$No_Apis_visit_rate,p10$Year,p10.1,
p11$No_Apis_visit_rate,p11$Year,p11.1,
p12$No_Apis_visit_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```


\newpage
**Visitation rate of hymenoptera **

**A-** linear model: lm(Seeds ~ No_Apis_visitatio_rate * Year)
```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}
#model
mod_seed_year_hym<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ Hym_visit * Year,data))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_seed_year_hym<-mod_seed_year_hym %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_seed_year_hym %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_seed_year_hym$p.value < 0.05| is.na(mod_seed_year_hym$p.value), T, F) )%>%
  kable_styling(position="left")

```


\newpage


```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}

mod_seed_year_hym.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ Hym_visit * Year,data)))

ggarrange(plot_model(mod_seed_year_hym.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)

```


\newpage

Predicted values of Seeds 

*Cistus libanotis*- *Cistus monspeliensis* - *Halimium calycinum* - *Halimium halimifolium* - *Teucrium fructicans* 
Warning message:
In predict.lm(model, newdata = fitfram, type = "response", se.fit = se,:  prediction from a rank-deficient fit may be misleading

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_seed_year_hym.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_seed_year_hym.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_seed_year_hym.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_seed_year_hym.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_seed_year_hym.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_seed_year_hym.1$mod[[6]], type = "pred",title = " Cistus salviifolius")

p1.1=plot_model(mod_seed_year_hym.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_seed_year_hym.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_seed_year_hym.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_seed_year_hym.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_seed_year_hym.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_seed_year_hym.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$Hym_visit,p1$Year,p1.1,
p2$Hym_visit,p2$Year,p2.1,
p3$Hym_visit,p3$Year,p3.1,
p4$Hym_visit,p4$Year,p4.1,
p5$Hym_visit,p5$Year,p5.1,
p6$Hym_visit,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_seed_year_hym.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_seed_year_hym.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_seed_year_hym.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_seed_year_hym.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_seed_year_hym.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_seed_year_hym.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_seed_year_hym.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_seed_year_hym.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_seed_year_hym.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_seed_year_hym.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_seed_year_hym.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_seed_year_hym.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)


ggarrange(p7$Hym_visit,p7$Year,p7.1,
p8$Hym_visit,p8$Year,p8.1,
p9$Hym_visit,p9$Year,p9.1,
p10$Hym_visit,p10$Year,p10.1,
p11$Hym_visit,p11$Year,p11.1,
p12$Hym_visit,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage 

**B-** linear mixed model with site ID like random factor
fixed-effect model matrix is rank deficient so dropping 1 column / coefficient de varia especies

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

#model
mod_mix_seed_year_hym<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(model = list(lmer(Seeds ~ Hym_visit * Year + (1 | Site_ID),data))) %>%
  summarise(broom.mixed::tidy(model)) %>%
  ungroup()



mod_mix_seed_year_hym<-mod_mix_seed_year_hym %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_seed_year_hym<-filter(mod_mix_seed_year_hym, !term == "sd__(Intercept)" & !term =="sd__Observation")


mod_mix_seed_year_hym %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(7, bold = ifelse(mod_mix_seed_year_hym$p.value < 0.05, T, F) )%>%  kable_styling(position="left")

```


\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}
#model plot
mod_mix_seed_year_hym.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lmer(Seeds ~ Hym_visit * Year + (1 | Site_ID),data)))


ggarrange(plot_model(mod_mix_seed_year_hym.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)

```

\newpage
Predicted values of Seeds 

*Cistus libanotis*- *Cistus monspeliensis* - *Halimium calycinum* - *Halimium halimifolium* - *Teucrium fructicans* 
Could not compute variance-covariance matrix of predictions. No confidence intervals are returned.
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_mix_seed_year_hym.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_mix_seed_year_hym.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_seed_year_hym.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_seed_year_hym.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_seed_year_hym.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_mix_seed_year_hym.1$mod[[6]], type = "pred",title = " Cistus salviifolius")

p1.1=plot_model(mod_mix_seed_year_hym.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_mix_seed_year_hym.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_mix_seed_year_hym.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_mix_seed_year_hym.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_mix_seed_year_hym.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_mix_seed_year_hym.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$Hym_visit,p1$Year,p1.1,
p2$Hym_visit,p2$Year,p2.1,
p3$Hym_visit,p3$Year,p3.1,
p4$Hym_visit,p4$Year,p4.1,
p5$Hym_visit,p5$Year,p5.1,
p6$Hym_visit,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_seed_year_hym.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_seed_year_hym.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_seed_year_hym.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_seed_year_hym.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_seed_year_hym.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_seed_year_hym.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_mix_seed_year_hym.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_mix_seed_year_hym.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_mix_seed_year_hym.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_mix_seed_year_hym.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_mix_seed_year_hym.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_mix_seed_year_hym.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)


ggarrange(p7$Hym_visit,p7$Year,p7.1,
p8$Hym_visit,p8$Year,p8.1,
p9$Hym_visit,p9$Year,p9.1,
p10$Hym_visit,p10$Year,p10.1,
p11$Hym_visit,p11$Year,p11.1,
p12$Hym_visit,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**Visitation rate of hymenoptera without A.mellifera **

**A-** linear model: lm(Seeds ~ No_Apis_visitatio_rate * Year)
```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}
# linear model 
mod_seed_year_hym_no_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ Hym_visit_sin_apis * Year,data))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_seed_year_hym_no_apis<-mod_seed_year_hym_no_apis %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_seed_year_hym_no_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_seed_year_hym_no_apis$p.value < 0.05| is.na(mod_seed_year_hym_no_apis$p.value), T, F) )%>%
  kable_styling(position="left")

```


\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}
#model plot
mod_seed_year_hym_no_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ Hym_visit_sin_apis * Year,data)))


ggarrange(plot_model(mod_seed_year_hym_no_apis.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_hym_no_apis.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)

```

\newpage

Predicted values of Seeds 

*Cistus libanotis*- *Cistus monspeliensis* - *Halimium calycinum* - *Halimium halimifolium* - *Teucrium fructicans* 
Warning message:
In predict.lm(model, newdata = fitfram, type = "response", se.fit = se,:  prediction from a rank-deficient fit may be misleading

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_seed_year_hym_no_apis.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_seed_year_hym_no_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_seed_year_hym_no_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_seed_year_hym_no_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_seed_year_hym_no_apis.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_seed_year_hym_no_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")

p1.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$Hym_visit_sin_apis,p1$Year,p1.1,
p2$Hym_visit_sin_apis,p2$Year,p2.1,
p3$Hym_visit_sin_apis,p3$Year,p3.1,
p4$Hym_visit_sin_apis,p4$Year,p4.1,
p5$Hym_visit_sin_apis,p5$Year,p5.1,
p6$Hym_visit_sin_apis,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_seed_year_hym_no_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_seed_year_hym_no_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_seed_year_hym_no_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_seed_year_hym_no_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_seed_year_hym_no_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_seed_year_hym_no_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_seed_year_hym_no_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)



ggarrange(p7$Hym_visit_sin_apis,p7$Year,p7.1,
p8$Hym_visit_sin_apis,p8$Year,p8.1,
p9$Hym_visit_sin_apis,p9$Year,p9.1,
p10$Hym_visit_sin_apis,p10$Year,p10.1,
p11$Hym_visit_sin_apis,p11$Year,p11.1,
p12$Hym_visit_sin_apis,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage 

**B-** linear mixed model with site ID like random factor

Warning messages:Some predictor variables are on very different scales: consider rescaling. The warning occurred in Salvia rosmarinus

fixed-effect model matrix is rank deficient so dropping 1 column / coefficient

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

#model
mod_mix_seed_year_hym_no_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(model = list(lmer(Seeds ~ Hym_visit_sin_apis * Year + (1 | Site_ID),data))) %>%
  summarise(broom.mixed::tidy(model)) %>%
  ungroup()



mod_mix_seed_year_hym_no_apis<-mod_mix_seed_year_hym_no_apis %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_seed_year_hym_no_apis<-filter(mod_mix_seed_year_hym_no_apis, !term == "sd__(Intercept)" & !term =="sd__Observation")


mod_mix_seed_year_hym_no_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(7, bold = ifelse(mod_mix_seed_year_hym_no_apis$p.value < 0.05, T, F) )%>%  kable_styling(position="left")

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}
#model plot
mod_mix_seed_year_hym_no_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lmer(Seeds ~ Hym_visit_sin_apis * Year + (1 | Site_ID),data)))


ggarrange(plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)

```

\newpage
Predicted values of Seeds 

*Cistus libanotis*- *Cistus monspeliensis* - *Halimium calycinum* - *Halimium halimifolium* - *Teucrium fructicans* 
Could not compute variance-covariance matrix of predictions. No confidence intervals are returned.

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")

p1.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$Hym_visit_sin_apis,p1$Year,p1.1,
p2$Hym_visit_sin_apis,p2$Year,p2.1,
p3$Hym_visit_sin_apis,p3$Year,p3.1,
p4$Hym_visit_sin_apis,p4$Year,p4.1,
p5$Hym_visit_sin_apis,p5$Year,p5.1,
p6$Hym_visit_sin_apis,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_mix_seed_year_hym_no_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)


ggarrange(p7$Hym_visit_sin_apis,p7$Year,p7.1,
p8$Hym_visit_sin_apis,p8$Year,p8.1,
p9$Hym_visit_sin_apis,p9$Year,p9.1,
p10$Hym_visit_sin_apis,p10$Year,p10.1,
p11$Hym_visit_sin_apis,p11$Year,p11.1,
p12$Hym_visit_sin_apis,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**Richness **

**A-** linear model: lm(Seeds ~ richness * Year)

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}
# linear model 
mod_seed_year_richness<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ richness * Year,data))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_seed_year_richness<-mod_seed_year_richness %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_seed_year_richness %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_seed_year_richness$p.value < 0.05| is.na(mod_seed_year_richness$p.value), T, F) )%>%
  kable_styling(position="left")

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}
#model plot
mod_seed_year_richness.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lm(Seeds ~ richness * Year,data)))


ggarrange(plot_model(mod_seed_year_richness.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_seed_year_richness.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)

```

\newpage
Predicted values of Seeds 

*Aspodelus fistulosus* - *Cistus libanotis*- *Cistus monspeliensis* - *Halimium halimifolium* - *Lavandula stoechas* - *Teucrium fructicans* 
Warning message: In predict.lm(model, newdata = fitfram, type = "response", se.fit = se,:  prediction from a rank-deficient fit may be misleading

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_seed_year_richness.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_seed_year_richness.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_seed_year_richness.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_seed_year_richness.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_seed_year_richness.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_seed_year_richness.1$mod[[6]], type = "pred",title = " Cistus salviifolius")

p1.1=plot_model(mod_seed_year_richness.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_seed_year_richness.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_seed_year_richness.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_seed_year_richness.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_seed_year_richness.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_seed_year_richness.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$richness,p1$Year,p1.1,
p2$richness,p2$Year,p2.1,
p3$richness,p3$Year,p3.1,
p4$richness,p4$Year,p4.1,
p5$richness,p5$Year,p5.1,
p6$richness,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_seed_year_richness.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_seed_year_richness.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_seed_year_richness.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_seed_year_richness.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_seed_year_richness.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_seed_year_richness.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_seed_year_richness.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_seed_year_richness.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_seed_year_richness.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_seed_year_richness.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_seed_year_richness.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_seed_year_richness.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)



ggarrange(p7$richness,p7$Year,p7.1,
p8$richness,p8$Year,p8.1,
p9$richness,p9$Year,p9.1,
p10$richness,p10$Year,p10.1,
p11$richness,p11$Year,p11.1,
p12$richness,p12$Year,p12.1,ncol=3,nrow = 6)

```


\newpage 

**B-** linear mixed model with site ID like random factor
```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

#model
mod_mix_seed_year_richness<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(model = list(lmer(Seeds ~ richness * Year + (1 | Site_ID),data))) %>%
  summarise(broom.mixed::tidy(model)) %>%
  ungroup()



mod_mix_seed_year_richness<-mod_mix_seed_year_richness %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_seed_year_richness<-filter(mod_mix_seed_year_richness, !term == "sd__(Intercept)" & !term =="sd__Observation")


mod_mix_seed_year_richness %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(7, bold = ifelse(mod_mix_seed_year_richness$p.value < 0.05, T, F) )%>%  kable_styling(position="left")

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 20,fig.width=22, out.width="100%"}
#model plot
mod_mix_seed_year_richness.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(lmer(Seeds ~ richness * Year + (1 | Site_ID),data)))


ggarrange(plot_model(mod_mix_seed_year_richness.1$mod[[1]], title = " Asphodelus fistulosus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[2]], title = "  Cistus crispus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[3]], title = " Cistus ladanifer",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[4]], title = "Cistus libanotis",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[5]], title = "Cistus monspeliensis",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[6]], title = " Cistus salviifolius",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[7]], title = " Halimium calycinum",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[8]], title = " Halimium halimifolium",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[9]], title = " Lavandula pedunculata",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[10]], title = " Lavandula stoechas",show.values = TRUE,value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[11]], title = " Salvia rosmarinus",show.values = TRUE, value.offset = .3),
plot_model(mod_mix_seed_year_richness.1$mod[[12]], title = " Teucrium fruticans",show.values = TRUE, value.offset = .3),ncol=3,nrow = 4)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p1=plot_model(mod_mix_seed_year_richness.1$mod[[1]], type = "pred", title = "Asphodelus fistulosus")
p2=plot_model(mod_mix_seed_year_richness.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_seed_year_richness.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_seed_year_richness.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_seed_year_richness.1$mod[[5]], type = "pred", title = "Cistus monspeliensis")
p6=plot_model(mod_mix_seed_year_richness.1$mod[[6]], type = "pred",title = " Cistus salviifolius")

p1.1=plot_model(mod_mix_seed_year_richness.1$mod[[1]], type = "int", title = " Asphodelus fistulosus",show.data = TRUE)
p2.1=plot_model(mod_mix_seed_year_richness.1$mod[[2]], type = "int", title = " Cistus crispus",show.data = TRUE)
p3.1=plot_model(mod_mix_seed_year_richness.1$mod[[3]], type = "int", title = " Cistus ladanifer",show.data = TRUE)
p4.1=plot_model(mod_mix_seed_year_richness.1$mod[[4]], type = "int",title = "Cistus libanotis",show.data = TRUE)
p5.1=plot_model(mod_mix_seed_year_richness.1$mod[[5]], type = "int", title = " Cistus monspeliensis",show.data = TRUE)
p6.1=plot_model(mod_mix_seed_year_richness.1$mod[[6]], type = "int",title = " Cistus salviifolius",show.data = TRUE)

ggarrange(p1$richness,p1$Year,p1.1,
p2$richness,p2$Year,p2.1,
p3$richness,p3$Year,p3.1,
p4$richness,p4$Year,p4.1,
p5$richness,p5$Year,p5.1,
p6$richness,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_seed_year_richness.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_seed_year_richness.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_seed_year_richness.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_seed_year_richness.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_seed_year_richness.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_seed_year_richness.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_mix_seed_year_richness.1$mod[[7]], type = "int",title = " Halimium calycinum",show.data = TRUE)
p8.1=plot_model(mod_mix_seed_year_richness.1$mod[[8]], type = "int",title = " Halimium halimifolium",show.data = TRUE)
p9.1=plot_model(mod_mix_seed_year_richness.1$mod[[9]], type = "int",title = " Lavandula pedunculata",show.data = TRUE)
p10.1=plot_model(mod_mix_seed_year_richness.1$mod[[10]], type = "int",title = " Lavandula stoechas",show.data = TRUE)
p11.1=plot_model(mod_mix_seed_year_richness.1$mod[[11]], type = "int",title = " Salvia rosmarinus",show.data = TRUE)
p12.1=plot_model(mod_mix_seed_year_richness.1$mod[[12]], type = "int",title = " Teucrium fruticans",show.data = TRUE)

ggarrange(p7$richness,p7$Year,p7.1,
p8$richness,p8$Year,p8.1,
p9$richness,p9$Year,p9.1,
p10$richness,p10$Year,p10.1,
p11$richness,p11$Year,p11.1,
p12$richness,p12$Year,p12.1,ncol=3,nrow = 6)

```
\newpage

# Fruit proportion

**visitation rate (all pollinator)**

**A-** GLM binomial (cbind(fruit_formado, Fruit_No))

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

mod_fruit_year<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ visitatio_rate * Year,data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_fruit_year<-mod_fruit_year %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_fruit_year %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_fruit_year$p.value < 0.05| is.na(mod_fruit_year$p.value), T, F) )%>%
  kable_styling(position="left")

```


\newpage
*C.crispus*, *C.ladanifer*, *C.salviifolius*, *H.halimifolium*, *L.pedunculata*, *L.stoechas* -> Data were 'prettified'. Consider using terms="visitatio_rate [all] to get smooth plots.

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
mod_fruit_year.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ visitatio_rate * Year,data,family = binomial)))

p1=plot_model(mod_fruit_year.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_fruit_year.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_fruit_year.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_fruit_year.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_fruit_year.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_fruit_year.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_fruit_year.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_fruit_year.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_fruit_year.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_fruit_year.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_fruit_year.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_fruit_year.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$visitatio_rate,p1$Year,p1.1,
p2$visitatio_rate,p2$Year,p2.1,
p3$visitatio_rate,p3$Year,p3.1,
p4$visitatio_rate,p4$Year,p4.1,
p5$visitatio_rate,p5$Year,p5.1,
p6$visitatio_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_fruit_year.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_fruit_year.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_fruit_year.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_fruit_year.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_fruit_year.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_fruit_year.1$mod[[12]], type = "pred",title = " Teucrium fruticans")



p7.1=plot_model(mod_fruit_year.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_fruit_year.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_fruit_year.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_fruit_year.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_fruit_year.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_fruit_year.1$mod[[12]], type = "int",title = " Teucrium fruticans")


ggarrange(p7$visitatio_rate,p7$Year,p7.1,
p8$visitatio_rate,p8$Year,p8.1,
p9$visitatio_rate,p9$Year,p9.1,
p10$visitatio_rate,p10$Year,p10.1,
p11$visitatio_rate,p11$Year,p11.1,
p12$visitatio_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```
\newpage

**B-** GLMM binomial (ramdon= Site_ID)

```{r, echo=FALSE, warning=FALSE,message=FALSE, out.width="100%"}

# glmm binomial
mod_mix_fruit_year<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~visitatio_rate *Year + (1|Site_ID),data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_mix_fruit_year<-mod_mix_fruit_year %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_fruit_year<-filter(mod_mix_fruit_year, !term == "sd__(Intercept)")


mod_mix_fruit_year %>% 
kable("latex",booktabs = TRUE,digits =  4,longtable = T, linesep = "") %>% column_spec(6, bold = ifelse(mod_mix_fruit_year$p.value < 0.05, T, F) )%>%
  kable_styling(position="center", latex_option="hold_position")

```

boundary (singular) fit: see help('isSingular')
fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients

ademas There were 30 warnings (use warnings() to see them)
*Asphodelus* unable to evaluate scaled gradient and Hessian is numerically singular: parameters are not uniquely determined 
*C.crispus* Model failed to converge with max|grad| = 0.00813624 (tol = 0.002, component 1)
*Cistus ladanifer* unable to evaluate scaled gradient and Model failed to converge: degenerate Hessian with 1 negative eigenvalues
*Cistus monspeliensis* unable to evaluate scaled gradient and Hessian is numerically singular: parameters are not uniquely determined
*Cistus salviifolius* unable to evaluate scaled gradient and Model failed to converge: degenerate Hessian with 3 negative eigenvalues
*Halimium halimifolium* unable to evaluate scaled gradient and Hessian is numerically singular: parameters are not uniquely determined
*Lavandula stoechas* Model is nearly unidentifiable: large eigenvalue ratio - Rescale variables?
*Salvia rosmarinu* unable to evaluate scaled gradient and Hessian is numerically singular: parameters are not uniquely determined

\newpage

*C.crispus*, *C.ladanifer*, *C.salviifolius*, *H.halimifolium*, *L.pedunculata*, *L.stoechas* -> Data were 'prettified'. Consider using terms="visitatio_rate [all] to get smooth plots.
Could not compute variance-covariance matrix of predictions. No confidence intervals are returned

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
mod_mix_fruit_year.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~visitatio_rate *Year + (1|Site_ID),data,family = binomial)))


p1=plot_model(mod_mix_fruit_year.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_mix_fruit_year.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_fruit_year.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_fruit_year.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_fruit_year.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_mix_fruit_year.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_mix_fruit_year.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_mix_fruit_year.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_mix_fruit_year.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_mix_fruit_year.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_mix_fruit_year.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_mix_fruit_year.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$visitatio_rate,p1$Year,p1.1,
p2$visitatio_rate,p2$Year,p2.1,
p3$visitatio_rate,p3$Year,p3.1,
p4$visitatio_rate,p4$Year,p4.1,
p5$visitatio_rate,p5$Year,p5.1,
p6$visitatio_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_fruit_year.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_fruit_year.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_fruit_year.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_fruit_year.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_fruit_year.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_fruit_year.1$mod[[12]], type = "pred",title = " Teucrium fruticans")



p7.1=plot_model(mod_mix_fruit_year.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_mix_fruit_year.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_mix_fruit_year.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_mix_fruit_year.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_mix_fruit_year.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_mix_fruit_year.1$mod[[12]], type = "int",title = " Teucrium fruticans")


ggarrange(p7$visitatio_rate,p7$Year,p7.1,
p8$visitatio_rate,p8$Year,p8.1,
p9$visitatio_rate,p9$Year,p9.1,
p10$visitatio_rate,p10$Year,p10.1,
p11$visitatio_rate,p11$Year,p11.1,
p12$visitatio_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**visitation rate of *Apis mellifera* **

**A-** GLM binomial (cbind(fruit_formado, Fruit_No))

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

# glm binomial
mod_fruit_year_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ Apis_visit_rate * Year,data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_fruit_year_apis<-mod_fruit_year_apis %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_fruit_year_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_fruit_year_apis$p.value < 0.05| is.na(mod_fruit_year_apis$p.value), T, F) )%>%
  kable_styling(position="left")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#model plot
mod_fruit_year_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ Apis_visit_rate * Year,data,family = binomial)))


p1=plot_model(mod_fruit_year_apis.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_fruit_year_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_fruit_year_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_fruit_year_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_fruit_year_apis.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_fruit_year_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_fruit_year_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_fruit_year_apis.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_fruit_year_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_fruit_year_apis.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_fruit_year_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_fruit_year_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$Apis_visit_rate,p1$Year,p1.1,
p2$Apis_visit_rate,p2$Year,p2.1,
p3$Apis_visit_rate,p3$Year,p3.1,
p4$Apis_visit_rate,p4$Year,p4.1,
p5$Apis_visit_rate,p5$Year,p5.1,
p6$Apis_visit_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_fruit_year_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_fruit_year_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_fruit_year_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_fruit_year_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_fruit_year_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_fruit_year_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")



p7.1=plot_model(mod_fruit_year_apis.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_fruit_year_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_fruit_year_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_fruit_year_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_fruit_year_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_fruit_year_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans")



ggarrange(p7$Apis_visit_rate,p7$Year,p7.1,
p8$Apis_visit_rate,p8$Year,p8.1,
p9$Apis_visit_rate,p9$Year,p9.1,
p10$Apis_visit_rate,p10$Year,p10.1,
p11$Apis_visit_rate,p11$Year,p11.1,
p12$Apis_visit_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**B-** GLMM binomial (ramdon= Site_ID)

```{r, echo=FALSE, warning=FALSE,message=FALSE, out.width="100%"}

# glmm binomial
mod_mix_fruit_year_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~Apis_visit_rate *Year + (1|Site_ID),data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_mix_fruit_year_apis<-mod_mix_fruit_year_apis %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_fruit_year_apis<-filter(mod_mix_fruit_year_apis, !term == "sd__(Intercept)")


mod_mix_fruit_year_apis %>% 
kable("latex",booktabs = TRUE,digits =  4, longtable = T,linesep ="") %>% 
column_spec(6, bold = ifelse(mod_mix_fruit_year_apis$p.value < 0.05, T, F) )%>%  kable_styling(position="center", latex_option="hold_position")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#model plot
mod_mix_fruit_year_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~Apis_visit_rate *Year + (1|Site_ID),data,family = binomial)))


p1=plot_model(mod_mix_fruit_year_apis.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_mix_fruit_year_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_fruit_year_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_fruit_year_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_fruit_year_apis.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_mix_fruit_year_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_mix_fruit_year_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_mix_fruit_year_apis.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_mix_fruit_year_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_mix_fruit_year_apis.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_mix_fruit_year_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_mix_fruit_year_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$Apis_visit_rate,p1$Year,p1.1,
p2$Apis_visit_rate,p2$Year,p2.1,
p3$Apis_visit_rate,p3$Year,p3.1,
p4$Apis_visit_rate,p4$Year,p4.1,
p5$Apis_visit_rate,p5$Year,p5.1,
p6$Apis_visit_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_fruit_year_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_fruit_year_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_fruit_year_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_fruit_year_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_fruit_year_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p11=plot_model(mod_mix_fruit_year_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_mix_fruit_year_apis.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_mix_fruit_year_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_mix_fruit_year_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_mix_fruit_year_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_mix_fruit_year_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_mix_fruit_year_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans")


ggarrange(p7$Apis_visit_rate,p7$Year,p7.1,
p8$Apis_visit_rate,p8$Year,p8.1,
p9$Apis_visit_rate,p9$Year,p9.1,
p10$Apis_visit_rate,p10$Year,p10.1,
p11$Apis_visit_rate,p11$Year,p11.1,
p12$Apis_visit_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**visitation rate of pollinator without *Apis mellifera* **

**A-** GLM binomial (cbind(fruit_formado, Fruit_No))

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

# glm binomial
mod_fruit_year_no_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ No_Apis_visit_rate * Year,data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()

mod_fruit_year_no_apis<-mod_fruit_year_no_apis %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_fruit_year_no_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_fruit_year_no_apis$p.value < 0.05| is.na(mod_fruit_year_no_apis$p.value), T, F) )%>%
  kable_styling(position="left")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#model plot
mod_fruit_year_no_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ No_Apis_visit_rate * Year,data,family = binomial)))


p1=plot_model(mod_fruit_year_no_apis.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_fruit_year_no_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_fruit_year_no_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_fruit_year_no_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_fruit_year_no_apis.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_fruit_year_no_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_fruit_year_no_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_fruit_year_no_apis.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_fruit_year_no_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_fruit_year_no_apis.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_fruit_year_no_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_fruit_year_no_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$No_Apis_visit_rate,p1$Year,p1.1,
p2$No_Apis_visit_rate,p2$Year,p2.1,
p3$No_Apis_visit_rate,p3$Year,p3.1,
p4$No_Apis_visit_rate,p4$Year,p4.1,
p5$No_Apis_visit_rate,p5$Year,p5.1,
p6$No_Apis_visit_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_fruit_year_no_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_fruit_year_no_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_fruit_year_no_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_fruit_year_no_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_fruit_year_no_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_fruit_year_no_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_fruit_year_no_apis.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_fruit_year_no_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_fruit_year_no_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_fruit_year_no_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_fruit_year_no_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_fruit_year_no_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans")


ggarrange(p7$No_Apis_visit_rate,p7$Year,p7.1,
p8$No_Apis_visit_rate,p8$Year,p8.1,
p9$No_Apis_visit_rate,p9$Year,p9.1,
p10$No_Apis_visit_rate,p10$Year,p10.1,
p11$No_Apis_visit_rate,p11$Year,p11.1,
p12$No_Apis_visit_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**B-** GLMM binomial (ramdon= Site_ID)

```{r, echo=FALSE, warning=FALSE,message=FALSE, out.width="100%"}

# glmm binomial
mod_mix_fruit_year_no_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~No_Apis_visit_rate *Year + (1|Site_ID),data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_mix_fruit_year_no_apis<-mod_mix_fruit_year_no_apis %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_fruit_year_no_apis<-filter(mod_mix_fruit_year_no_apis, !term == "sd__(Intercept)")


mod_mix_fruit_year_no_apis %>% 
kable("latex",booktabs = TRUE,digits =  4, longtable = T,linesep ="") %>% 
column_spec(6, bold = ifelse(mod_mix_fruit_year_no_apis$p.value < 0.05, T, F) )%>%  kable_styling(position="center", latex_option="hold_position")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#model plot
mod_mix_fruit_year_no_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~No_Apis_visit_rate *Year + (1|Site_ID),data,family = binomial)))


p1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_mix_fruit_year_no_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_fruit_year_no_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_fruit_year_no_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_fruit_year_no_apis.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_mix_fruit_year_no_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$No_Apis_visit_rate,p1$Year,p1.1,
p2$No_Apis_visit_rate,p2$Year,p2.1,
p3$No_Apis_visit_rate,p3$Year,p3.1,
p4$No_Apis_visit_rate,p4$Year,p4.1,
p5$No_Apis_visit_rate,p5$Year,p5.1,
p6$No_Apis_visit_rate,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_fruit_year_no_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_fruit_year_no_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_fruit_year_no_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_fruit_year_no_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_fruit_year_no_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_fruit_year_no_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")



p7.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_mix_fruit_year_no_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans")


ggarrange(p7$No_Apis_visit_rate,p7$Year,p7.1,
p8$No_Apis_visit_rate,p8$Year,p8.1,
p9$No_Apis_visit_rate,p9$Year,p9.1,
p10$No_Apis_visit_rate,p10$Year,p10.1,
p11$No_Apis_visit_rate,p11$Year,p11.1,
p12$No_Apis_visit_rate,p12$Year,p12.1,ncol=3,nrow = 6)

```


\newpage
**visitation rate of hymenoptera **

**A-** GLM binomial (cbind(fruit_formado, Fruit_No))

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

# glm binomial
mod_fruit_year_hym<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ Hym_visit * Year,data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_fruit_year_hym<-mod_fruit_year_hym %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_fruit_year_hym %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_fruit_year_hym$p.value < 0.05| is.na(mod_fruit_year_hym$p.value), T, F) )%>%
  kable_styling(position="left")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#model plot
mod_fruit_year_hym.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ Hym_visit * Year,data,family = binomial)))



p1=plot_model(mod_fruit_year_hym.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_fruit_year_hym.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_fruit_year_hym.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_fruit_year_hym.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_fruit_year_hym.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_fruit_year_hym.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_fruit_year_hym.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_fruit_year_hym.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_fruit_year_hym.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_fruit_year_hym.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_fruit_year_hym.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_fruit_year_hym.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$Hym_visit,p1$Year,p1.1,
p2$Hym_visit,p2$Year,p2.1,
p3$Hym_visit,p3$Year,p3.1,
p4$Hym_visit,p4$Year,p4.1,
p5$Hym_visit,p5$Year,p5.1,
p6$Hym_visit,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_fruit_year_hym.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_fruit_year_hym.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_fruit_year_hym.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_fruit_year_hym.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_fruit_year_hym.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_fruit_year_hym.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_fruit_year_hym.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_fruit_year_hym.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_fruit_year_hym.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_fruit_year_hym.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_fruit_year_hym.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_fruit_year_hym.1$mod[[12]], type = "int",title = " Teucrium fruticans")



ggarrange(p7$Hym_visit,p7$Year,p7.1,
p8$Hym_visit,p8$Year,p8.1,
p9$Hym_visit,p9$Year,p9.1,
p10$Hym_visit,p10$Year,p10.1,
p11$Hym_visit,p11$Year,p11.1,
p12$Hym_visit,p12$Year,p12.1,ncol=3,nrow = 6)

```


\newpage
**B-** GLMM binomial (ramdon= Site_ID)

```{r, echo=FALSE, warning=FALSE,message=FALSE, out.width="100%"}

# glmm binomial
mod_mix_fruit_year_hym<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~Hym_visit *Year + (1|Site_ID),data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_mix_fruit_year_hym<-mod_mix_fruit_year_hym %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_fruit_year_hym<-filter(mod_mix_fruit_year_hym, !term == "sd__(Intercept)")


mod_mix_fruit_year_hym %>% 
kable("latex",booktabs = TRUE,digits =  4, longtable = T,linesep ="") %>% 
column_spec(6, bold = ifelse(mod_mix_fruit_year_hym$p.value < 0.05, T, F) )%>%  kable_styling(position="center", latex_option="hold_position")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#plot
mod_mix_fruit_year_hym.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~Hym_visit *Year + (1|Site_ID),data,family = binomial)))


p1=plot_model(mod_mix_fruit_year_hym.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_mix_fruit_year_hym.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_fruit_year_hym.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_fruit_year_hym.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_fruit_year_hym.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_mix_fruit_year_hym.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_mix_fruit_year_hym.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_mix_fruit_year_hym.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_mix_fruit_year_hym.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_mix_fruit_year_hym.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_mix_fruit_year_hym.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_mix_fruit_year_hym.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$Hym_visit,p1$Year,p1.1,
p2$Hym_visit,p2$Year,p2.1,
p3$Hym_visit,p3$Year,p3.1,
p4$Hym_visit,p4$Year,p4.1,
p5$Hym_visit,p5$Year,p5.1,
p6$Hym_visit,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_fruit_year_hym.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_fruit_year_hym.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_fruit_year_hym.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_fruit_year_hym.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_fruit_year_hym.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_fruit_year_hym.1$mod[[12]], type = "pred",title = " Teucrium fruticans")



p7.1=plot_model(mod_mix_fruit_year_hym.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_mix_fruit_year_hym.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_mix_fruit_year_hym.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_mix_fruit_year_hym.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_mix_fruit_year_hym.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_mix_fruit_year_hym.1$mod[[12]], type = "int",title = " Teucrium fruticans")



ggarrange(p7$Hym_visit,p7$Year,p7.1,
p8$Hym_visit,p8$Year,p8.1,
p9$Hym_visit,p9$Year,p9.1,
p10$Hym_visit,p10$Year,p10.1,
p11$Hym_visit,p11$Year,p11.1,
p12$Hym_visit,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**visitation rate of hymenoptera without *A. mellifera* **

**A-** GLM binomial (cbind(fruit_formado, Fruit_No))

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

# glm binomial
mod_fruit_year_hym_no_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ Hym_visit_sin_apis * Year,data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_fruit_year_hym_no_apis<-mod_fruit_year_hym_no_apis %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_fruit_year_hym_no_apis %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_fruit_year_hym_no_apis$p.value < 0.05| is.na(mod_fruit_year_hym_no_apis$p.value), T, F) )%>%
  kable_styling(position="left")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#model plot
mod_fruit_year_hym_no_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ Hym_visit_sin_apis * Year,data,family = binomial)))


p1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_fruit_year_hym_no_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_fruit_year_hym_no_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_fruit_year_hym_no_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_fruit_year_hym_no_apis.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_fruit_year_hym_no_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$Hym_visit_sin_apis,p1$Year,p1.1,
p2$Hym_visit_sin_apis,p2$Year,p2.1,
p3$Hym_visit_sin_apis,p3$Year,p3.1,
p4$Hym_visit_sin_apis,p4$Year,p4.1,
p5$Hym_visit_sin_apis,p5$Year,p5.1,
p6$Hym_visit_sin_apis,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_fruit_year_hym_no_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_fruit_year_hym_no_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_fruit_year_hym_no_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_fruit_year_hym_no_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_fruit_year_hym_no_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_fruit_year_hym_no_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_fruit_year_hym_no_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans")



ggarrange(p7$Hym_visit_sin_apis,p7$Year,p7.1,
p8$Hym_visit_sin_apis,p8$Year,p8.1,
p9$Hym_visit_sin_apis,p9$Year,p9.1,
p10$Hym_visit_sin_apis,p10$Year,p10.1,
p11$Hym_visit_sin_apis,p11$Year,p11.1,
p12$Hym_visit_sin_apis,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**B-** GLMM binomial (ramdon= Site_ID)

```{r, echo=FALSE, warning=FALSE,message=FALSE, out.width="100%"}

# glmm binomial
mod_mix_fruit_year_hym_no_apis<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~Hym_visit_sin_apis *Year + (1|Site_ID),data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_mix_fruit_year_hym_no_apis<-mod_mix_fruit_year_hym_no_apis %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_fruit_year_hym_no_apis<-filter(mod_mix_fruit_year_hym_no_apis, !term == "sd__(Intercept)")


mod_mix_fruit_year_hym_no_apis %>% 
kable("latex",booktabs = TRUE,digits =  4, longtable = T,linesep ="") %>% 
column_spec(6, bold = ifelse(mod_mix_fruit_year_hym_no_apis$p.value < 0.05, T, F) )%>%  kable_styling(position="center", latex_option="hold_position")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#plot
mod_mix_fruit_year_hym_no_apis.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~Hym_visit_sin_apis *Year + (1|Site_ID),data,family = binomial)))



p1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$Hym_visit_sin_apis,p1$Year,p1.1,
p2$Hym_visit_sin_apis,p2$Year,p2.1,
p3$Hym_visit_sin_apis,p3$Year,p3.1,
p4$Hym_visit_sin_apis,p4$Year,p4.1,
p5$Hym_visit_sin_apis,p5$Year,p5.1,
p6$Hym_visit_sin_apis,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_mix_fruit_year_hym_no_apis.1$mod[[12]], type = "int",title = " Teucrium fruticans")



ggarrange(p7$Hym_visit_sin_apis,p7$Year,p7.1,
p8$Hym_visit_sin_apis,p8$Year,p8.1,
p9$Hym_visit_sin_apis,p9$Year,p9.1,
p10$Hym_visit_sin_apis,p10$Year,p10.1,
p11$Hym_visit_sin_apis,p11$Year,p11.1,
p12$Hym_visit_sin_apis,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**Richness**

**A-** GLM binomial (cbind(fruit_formado, Fruit_No))

```{r,echo=FALSE, warning=FALSE,message=FALSE,fig.height = 13,fig.width=15, out.width="100%"}

# glm binomial
mod_fruit_year_richness<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ richness * Year,data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_fruit_year_richness<-mod_fruit_year_richness %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))

mod_fruit_year_richness %>% 
 kable("latex",booktabs = TRUE, digits =  4,longtable = T, linesep = "") %>% 
column_spec(6, bold = ifelse(mod_fruit_year_richness$p.value < 0.05| is.na(mod_fruit_year_richness$p.value), T, F) )%>%
  kable_styling(position="left")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#model plot
mod_fruit_year_richness.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glm(cbind(fruit_formado,Fruit_No) ~ richness * Year,data,family = binomial)))


p1=plot_model(mod_fruit_year_richness.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_fruit_year_richness.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_fruit_year_richness.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_fruit_year_richness.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_fruit_year_richness.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_fruit_year_richness.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_fruit_year_richness.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_fruit_year_richness.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_fruit_year_richness.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_fruit_year_richness.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_fruit_year_richness.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_fruit_year_richness.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$richness,p1$Year,p1.1,
p2$richness,p2$Year,p2.1,
p3$richness,p3$Year,p3.1,
p4$richness,p4$Year,p4.1,
p5$richness,p5$Year,p5.1,
p6$richness,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_fruit_year_richness.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_fruit_year_richness.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_fruit_year_richness.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_fruit_year_richness.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_fruit_year_richness.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_fruit_year_richness.1$mod[[12]], type = "pred",title = " Teucrium fruticans")



p7.1=plot_model(mod_fruit_year_richness.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_fruit_year_richness.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_fruit_year_richness.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_fruit_year_richness.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_fruit_year_richness.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_fruit_year_richness.1$mod[[12]], type = "int",title = " Teucrium fruticans")



ggarrange(p7$richness,p7$Year,p7.1,
p8$richness,p8$Year,p8.1,
p9$richness,p9$Year,p9.1,
p10$richness,p10$Year,p10.1,
p11$richness,p11$Year,p11.1,
p12$richness,p12$Year,p12.1,ncol=3,nrow = 6)

```

\newpage
**B-** GLMM binomial (ramdon= Site_ID)

```{r, echo=FALSE, warning=FALSE,message=FALSE, out.width="100%"}

# glmm binomial
mod_mix_fruit_year_richness<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~richness *Year + (1|Site_ID),data,family = binomial))) %>%
  summarize(tidy(mod))%>%
  ungroup()


mod_mix_fruit_year_richness<-mod_mix_fruit_year_richness %>%
  select(-effect, -group)  %>%
  mutate(Plant_gen_sp = replace(Plant_gen_sp, duplicated(Plant_gen_sp), ""))
  
mod_mix_fruit_year_richness<-filter(mod_mix_fruit_year_richness, !term == "sd__(Intercept)")


mod_mix_fruit_year_richness %>% 
kable("latex",booktabs = TRUE,digits =  4, longtable = T,linesep ="") %>% 
column_spec(6, bold = ifelse(mod_mix_fruit_year_richness$p.value < 0.05, T, F) )%>%  kable_styling(position="center", latex_option="hold_position")

```

\newpage

```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}
#plot
mod_mix_fruit_year_richness.1<-Pollinator_Plant %>%
  nest_by(Plant_gen_sp) %>%
  mutate(mod = list(glmer(cbind(fruit_formado, Fruit_No)~richness *Year + (1|Site_ID),data,family = binomial)))


p1=plot_model(mod_mix_fruit_year_richness.1$mod[[1]], type = "pred", title = " Asphodelus fistulosus")
p2=plot_model(mod_mix_fruit_year_richness.1$mod[[2]], type = "pred", title = " Cistus crispus")
p3=plot_model(mod_mix_fruit_year_richness.1$mod[[3]], type = "pred", title = " Cistus ladanifer")
p4=plot_model(mod_mix_fruit_year_richness.1$mod[[4]], type = "pred",title = "Cistus libanotis")
p5=plot_model(mod_mix_fruit_year_richness.1$mod[[5]], type = "pred", title = " Cistus monspeliensis")
p6=plot_model(mod_mix_fruit_year_richness.1$mod[[6]], type = "pred",title = " Cistus salviifolius")


p1.1=plot_model(mod_mix_fruit_year_richness.1$mod[[1]], type = "int", title = " Asphodelus fistulosus")
p2.1=plot_model(mod_mix_fruit_year_richness.1$mod[[2]], type = "int", title = " Cistus crispus")
p3.1=plot_model(mod_mix_fruit_year_richness.1$mod[[3]], type = "int", title = " Cistus ladanifer")
p4.1=plot_model(mod_mix_fruit_year_richness.1$mod[[4]], type = "int",title = "Cistus libanotis")
p5.1=plot_model(mod_mix_fruit_year_richness.1$mod[[5]], type = "int", title = " Cistus monspeliensis")
p6.1=plot_model(mod_mix_fruit_year_richness.1$mod[[6]], type = "int",title = " Cistus salviifolius")

ggarrange(p1$richness,p1$Year,p1.1,
p2$richness,p2$Year,p2.1,
p3$richness,p3$Year,p3.1,
p4$richness,p4$Year,p4.1,
p5$richness,p5$Year,p5.1,
p6$richness,p6$Year,p6.1,ncol=3,nrow = 6)

```

\newpage
```{r,echo=FALSE, warning=FALSE,message=FALSE, fig.height = 30,fig.width=25, out.width="100%"}

p7=plot_model(mod_mix_fruit_year_richness.1$mod[[7]], type = "pred",title = " Halimium calycinum")
p8=plot_model(mod_mix_fruit_year_richness.1$mod[[8]], type = "pred",title = " Halimium halimifolium")
p9=plot_model(mod_mix_fruit_year_richness.1$mod[[9]], type = "pred",title = " Lavandula pedunculata")
p10=plot_model(mod_mix_fruit_year_richness.1$mod[[10]], type = "pred",title = " Lavandula stoechas")
p11=plot_model(mod_mix_fruit_year_richness.1$mod[[11]], type = "pred",title = " Salvia rosmarinus")
p12=plot_model(mod_mix_fruit_year_richness.1$mod[[12]], type = "pred",title = " Teucrium fruticans")


p7.1=plot_model(mod_mix_fruit_year_richness.1$mod[[7]], type = "int",title = " Halimium calycinum")
p8.1=plot_model(mod_mix_fruit_year_richness.1$mod[[8]], type = "int",title = " Halimium halimifolium")
p9.1=plot_model(mod_mix_fruit_year_richness.1$mod[[9]], type = "int",title = " Lavandula pedunculata")
p10.1=plot_model(mod_mix_fruit_year_richness.1$mod[[10]], type = "int",title = " Lavandula stoechas")
p11.1=plot_model(mod_mix_fruit_year_richness.1$mod[[11]], type = "int",title = " Salvia rosmarinus")
p12.1=plot_model(mod_mix_fruit_year_richness.1$mod[[12]], type = "int",title = " Teucrium fruticans")


ggarrange(p7$richness,p7$Year,p7.1,
p8$richness,p8$Year,p8.1,
p9$richness,p9$Year,p9.1,
p10$richness,p10$Year,p10.1,
p11$richness,p11$Year,p11.1,
p12$richness,p12$Year,p12.1,ncol=3,nrow = 6)

```
